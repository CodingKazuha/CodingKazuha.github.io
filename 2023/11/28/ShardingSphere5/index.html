

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.jpg">
  <link rel="icon" href="/img/logo.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="Á¨¨01Á´† È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè‰∫íËÅîÁΩë‰∏öÂä°ÂÖ¥Ëµ∑‰πãÂêéÔºåÊµ∑ÈáèÁî®Êà∑Âä†‰∏äÊµ∑ÈáèÊï∞ÊçÆÁöÑÁâπÁÇπÔºåÂçï‰∏™Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®Â∑≤ÁªèÈöæ‰ª•Êª°Ë∂≥‰∏öÂä°ÈúÄË¶ÅÔºåÂøÖÈ°ªËÄÉËôëÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑÊñπÂºèÊù•ÊèêÂçáÊÄßËÉΩ„ÄÇÈ´òÊÄßËÉΩÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑÁ¨¨‰∏ÄÁßçÊñπÂºèÊòØ‚ÄúËØªÂÜôÂàÜÁ¶ª‚ÄùÔºåÁ¨¨‰∫åÁßçÊñπÂºèÊòØ‚ÄúÊï∞ÊçÆÂ∫ìÂàÜÁâá‚Äù 1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑËØªÂÜôÂàÜÁ¶ªÂéüÁêÜÔºöËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂéüÁêÜÊòØÂ∞ÜÊï∞ÊçÆÂ∫ìËØªÂÜôÊìç‰ΩúÂàÜÊï£Âà∞‰∏çÂêåÁöÑËäÇÁÇπ‰∏äÔºå‰∏ãÈù¢ÊòØÂÖ∂Âü∫Êú¨Êû∂ÊûÑÂõæÔºö  ËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂÆûÁé∞Ôºö  ‰∏ªÂ∫ìË¥üË¥£Â§ÑÁêÜ‰∫ãÂä°ÊÄßÁöÑÂ¢ûÂà†ÊîπÊìç‰ΩúÔºå‰ªéÂ∫ìË¥üË¥£Â§ÑÁêÜÊü•ËØ¢">
<meta property="og:type" content="article">
<meta property="og:title" content="ShardingSphere5">
<meta property="og:url" content="http://example.com/2023/11/28/ShardingSphere5/index.html">
<meta property="og:site_name" content="codingkazuha">
<meta property="og:description" content="Á¨¨01Á´† È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè‰∫íËÅîÁΩë‰∏öÂä°ÂÖ¥Ëµ∑‰πãÂêéÔºåÊµ∑ÈáèÁî®Êà∑Âä†‰∏äÊµ∑ÈáèÊï∞ÊçÆÁöÑÁâπÁÇπÔºåÂçï‰∏™Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®Â∑≤ÁªèÈöæ‰ª•Êª°Ë∂≥‰∏öÂä°ÈúÄË¶ÅÔºåÂøÖÈ°ªËÄÉËôëÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑÊñπÂºèÊù•ÊèêÂçáÊÄßËÉΩ„ÄÇÈ´òÊÄßËÉΩÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑÁ¨¨‰∏ÄÁßçÊñπÂºèÊòØ‚ÄúËØªÂÜôÂàÜÁ¶ª‚ÄùÔºåÁ¨¨‰∫åÁßçÊñπÂºèÊòØ‚ÄúÊï∞ÊçÆÂ∫ìÂàÜÁâá‚Äù 1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑËØªÂÜôÂàÜÁ¶ªÂéüÁêÜÔºöËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂéüÁêÜÊòØÂ∞ÜÊï∞ÊçÆÂ∫ìËØªÂÜôÊìç‰ΩúÂàÜÊï£Âà∞‰∏çÂêåÁöÑËäÇÁÇπ‰∏äÔºå‰∏ãÈù¢ÊòØÂÖ∂Âü∫Êú¨Êû∂ÊûÑÂõæÔºö  ËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂÆûÁé∞Ôºö  ‰∏ªÂ∫ìË¥üË¥£Â§ÑÁêÜ‰∫ãÂä°ÊÄßÁöÑÂ¢ûÂà†ÊîπÊìç‰ΩúÔºå‰ªéÂ∫ìË¥üË¥£Â§ÑÁêÜÊü•ËØ¢">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/362d22168bf344687ec0c206aa115807.jpg">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804223138651.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/6e7d7bd54d7a4eb67918080863d354d7.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/2ccafe41de9bd7f8dec4658f004310d6.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/71f41d46cc5c0405f4d4dc944b4350c9.jpg">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804221855449.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/136bc2f01919edcb8271df6f7e71af40.jpg">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804222212087.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804223321167.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/f8d538f9201e3ebee37dfdcd1922e9df.jpg">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/2a2dba7f07581fd055d9cd5a3aa8388e.jpg">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804195402870.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804195432673.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220714133617856.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220807183231101.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/0.08703112216569037.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220804191852164.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220715000533951.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220714235426120.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220715004850504.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220807232456342.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220810163534068.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220808033239206.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220819152009158.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220819152009158.png">
<meta property="og:image" content="http://example.com/2023/11/28/ShardingSphere5/image-20220819151154763.png">
<meta property="article:published_time" content="2023-11-28T09:34:52.000Z">
<meta property="article:modified_time" content="2023-11-29T01:48:35.092Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2023/11/28/ShardingSphere5/362d22168bf344687ec0c206aa115807.jpg">
  
  
  
  <title>ShardingSphere5 - codingkazuha</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/scroll.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/gradient.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"üòé","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>codingkazuhaÁöÑÂçöÂÆ¢</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>È¶ñÈ°µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>ÂΩíÊ°£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>ÂàÜÁ±ª</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Ê†áÁ≠æ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>ÂÖ≥‰∫é</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ShardingSphere5"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-11-28 17:34" pubdate>
          2023Âπ¥11Êúà28Êó• ‰∏ãÂçà
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          40k Â≠ó
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          336 ÂàÜÈíü
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ShardingSphere5</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Á¨¨01Á´†-È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè"><a href="#Á¨¨01Á´†-È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè" class="headerlink" title="Á¨¨01Á´† È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè"></a>Á¨¨01Á´† È´òÊÄßËÉΩÊû∂ÊûÑÊ®°Âºè</h1><p>‰∫íËÅîÁΩë‰∏öÂä°ÂÖ¥Ëµ∑‰πãÂêéÔºåÊµ∑ÈáèÁî®Êà∑Âä†‰∏äÊµ∑ÈáèÊï∞ÊçÆÁöÑÁâπÁÇπÔºåÂçï‰∏™Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®Â∑≤ÁªèÈöæ‰ª•Êª°Ë∂≥‰∏öÂä°ÈúÄË¶ÅÔºåÂøÖÈ°ªËÄÉËôëÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑÊñπÂºèÊù•ÊèêÂçáÊÄßËÉΩ„ÄÇÈ´òÊÄßËÉΩÊï∞ÊçÆÂ∫ìÈõÜÁæ§ÁöÑ<code>Á¨¨‰∏ÄÁßçÊñπÂºèÊòØ‚ÄúËØªÂÜôÂàÜÁ¶ª‚Äù</code>Ôºå<code>Á¨¨‰∫åÁßçÊñπÂºèÊòØ‚ÄúÊï∞ÊçÆÂ∫ìÂàÜÁâá‚Äù</code></p>
<h2 id="1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑ"><a href="#1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑ" class="headerlink" title="1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑ"></a>1„ÄÅËØªÂÜôÂàÜÁ¶ªÊû∂ÊûÑ</h2><p><strong>ËØªÂÜôÂàÜÁ¶ªÂéüÁêÜÔºö</strong>ËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂéüÁêÜÊòØÂ∞ÜÊï∞ÊçÆÂ∫ìËØªÂÜôÊìç‰ΩúÂàÜÊï£Âà∞‰∏çÂêåÁöÑËäÇÁÇπ‰∏äÔºå‰∏ãÈù¢ÊòØÂÖ∂Âü∫Êú¨Êû∂ÊûÑÂõæÔºö</p>
<p><img src="362d22168bf344687ec0c206aa115807.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>ËØªÂÜôÂàÜÁ¶ªÁöÑÂü∫Êú¨ÂÆûÁé∞Ôºö</strong></p>
<ul>
<li><code>‰∏ªÂ∫ìË¥üË¥£Â§ÑÁêÜ‰∫ãÂä°ÊÄßÁöÑÂ¢ûÂà†ÊîπÊìç‰ΩúÔºå‰ªéÂ∫ìË¥üË¥£Â§ÑÁêÜÊü•ËØ¢Êìç‰Ωú</code>ÔºåËÉΩÂ§üÊúâÊïàÁöÑÈÅøÂÖçÁî±Êï∞ÊçÆÊõ¥Êñ∞ÂØºËá¥ÁöÑË°åÈîÅÔºå‰ΩøÂæóÊï¥‰∏™Á≥ªÁªüÁöÑÊü•ËØ¢ÊÄßËÉΩÂæóÂà∞ÊûÅÂ§ßÁöÑÊîπÂñÑ„ÄÇ</li>
<li>ËØªÂÜôÂàÜÁ¶ªÊòØ<code>Ê†πÊçÆ SQL ËØ≠‰πâÁöÑÂàÜÊûê</code>Ôºå<code>Â∞ÜËØªÊìç‰ΩúÂíåÂÜôÊìç‰ΩúÂàÜÂà´Ë∑ØÁî±Ëá≥‰∏ªÂ∫ì‰∏é‰ªéÂ∫ì</code>„ÄÇ</li>
<li>ÈÄöËøá<code>‰∏Ä‰∏ªÂ§ö‰ªé</code>ÁöÑÈÖçÁΩÆÊñπÂºèÔºåÂèØ‰ª•Â∞ÜÊü•ËØ¢ËØ∑Ê±ÇÂùáÂåÄÁöÑÂàÜÊï£Âà∞Â§ö‰∏™Êï∞ÊçÆÂâØÊú¨ÔºåËÉΩÂ§üËøõ‰∏ÄÊ≠•ÁöÑÊèêÂçáÁ≥ªÁªüÁöÑÂ§ÑÁêÜËÉΩÂäõ„ÄÇ </li>
<li>‰ΩøÁî®<code>Â§ö‰∏ªÂ§ö‰ªé</code>ÁöÑÊñπÂºèÔºå‰∏ç‰ΩÜËÉΩÂ§üÊèêÂçáÁ≥ªÁªüÁöÑÂêûÂêêÈáèÔºåËøòËÉΩÂ§üÊèêÂçáÁ≥ªÁªüÁöÑÂèØÁî®ÊÄßÔºåÂèØ‰ª•ËææÂà∞Âú®‰ªª‰Ωï‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÂÆïÊú∫ÔºåÁîöËá≥Á£ÅÁõòÁâ©ÁêÜÊçüÂùèÁöÑÊÉÖÂÜµ‰∏ã‰ªçÁÑ∂‰∏çÂΩ±ÂìçÁ≥ªÁªüÁöÑÊ≠£Â∏∏ËøêË°å„ÄÇ</li>
</ul>
<p><strong>‰∏ãÂõæÂ±ïÁ§∫‰∫ÜÊ†πÊçÆ‰∏öÂä°ÈúÄË¶ÅÔºåÂ∞ÜÁî®Êà∑Ë°®ÁöÑÂÜôÊìç‰ΩúÂíåËØªÊìçË∑ØÁî±Âà∞‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÁöÑÊñπÊ°àÔºö</strong></p>
<p><img src="image-20220804223138651.png" srcset="/img/loading.gif" lazyload alt="image-20220804223138651"></p>
<p><strong>CAP ÁêÜËÆ∫Ôºö</strong></p>
<p>CAP ÂÆöÁêÜÔºàCAP theoremÔºâÂèàË¢´Áß∞‰ΩúÂ∏ÉÈ≤ÅÂ∞îÂÆöÁêÜÔºàBrewer‚Äôs theoremÔºâÔºåÊòØÂä†Â∑ûÂ§ßÂ≠¶‰ºØÂÖãÂà©ÂàÜÊ†°ÁöÑËÆ°ÁÆóÊú∫ÁßëÂ≠¶ÂÆ∂ÂüÉÈáåÂÖã¬∑Â∏ÉÈ≤ÅÂ∞îÔºàEric BrewerÔºâÂú® 2000 Âπ¥ÁöÑ ACM PODC ‰∏äÊèêÂá∫ÁöÑ‰∏Ä‰∏™ÁåúÊÉ≥„ÄÇ<code>ÂØπ‰∫éËÆæËÆ°ÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁöÑÊû∂ÊûÑÂ∏àÊù•ËØ¥ÔºåCAP ÊòØÂøÖÈ°ªÊéåÊè°ÁöÑÁêÜËÆ∫„ÄÇ</code></p>
<p>Âú®‰∏Ä‰∏™<code>ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠</code>ÔºåÂΩìÊ∂âÂèäËØªÂÜôÊìç‰ΩúÊó∂ÔºåÂè™ËÉΩ‰øùËØÅ‰∏ÄËá¥ÊÄßÔºàConsistenceÔºâ„ÄÅÂèØÁî®ÊÄßÔºàAvailabilityÔºâ„ÄÅÂàÜÂå∫ÂÆπÈîôÊÄßÔºàPartition ToleranceÔºâ‰∏âËÄÖ‰∏≠ÁöÑ‰∏§‰∏™ÔºåÂè¶Â§ñ‰∏Ä‰∏™ÂøÖÈ°ªË¢´Áâ∫Áâ≤„ÄÇ</p>
<ul>
<li>C ‰∏ÄËá¥ÊÄßÔºàConsistencyÔºâÔºöÂØπÊüê‰∏™ÊåáÂÆöÁöÑÂÆ¢Êà∑Á´ØÊù•ËØ¥ÔºåËØªÊìç‰Ωú‰øùËØÅËÉΩÂ§üËøîÂõûÊúÄÊñ∞ÁöÑÂÜôÊìç‰ΩúÁªìÊûú</li>
<li>A ÂèØÁî®ÊÄßÔºàAvailabilityÔºâÔºöÈùûÊïÖÈöúÁöÑËäÇÁÇπÂú®ÂêàÁêÜÁöÑÊó∂Èó¥ÂÜÖËøîÂõûÂêàÁêÜÁöÑÂìçÂ∫î<code>Ôºà‰∏çÊòØÈîôËØØÂíåË∂ÖÊó∂ÁöÑÂìçÂ∫îÔºâ</code></li>
<li>P ÂàÜÂå∫ÂÆπÂøçÊÄßÔºàPartition ToleranceÔºâÔºöÂΩìÂá∫Áé∞ÁΩëÁªúÂàÜÂå∫Âêé<code>ÔºàÂèØËÉΩÊòØ‰∏¢ÂåÖÔºå‰πüÂèØËÉΩÊòØËøûÊé•‰∏≠Êñ≠ÔºåËøòÂèØËÉΩÊòØÊã•Â°ûÔºâ</code>ÔºåÁ≥ªÁªüËÉΩÂ§üÁªßÁª≠‚ÄúÂ±•Ë°åËÅåË¥£‚Äù</li>
</ul>
<p><strong>CAPÁâπÁÇπÔºö</strong></p>
<ul>
<li><p>Âú®ÂÆûÈôÖËÆæËÆ°ËøáÁ®ã‰∏≠ÔºåÊØè‰∏™Á≥ªÁªü‰∏çÂèØËÉΩÂè™Â§ÑÁêÜ‰∏ÄÁßçÊï∞ÊçÆÔºåËÄåÊòØÂåÖÂê´Â§öÁßçÁ±ªÂûãÁöÑÊï∞ÊçÆÔºå<code>ÊúâÁöÑÊï∞ÊçÆÂøÖÈ°ªÈÄâÊã© CPÔºåÊúâÁöÑÊï∞ÊçÆÂøÖÈ°ªÈÄâÊã© APÔºåÂàÜÂ∏ÉÂºèÁ≥ªÁªüÁêÜËÆ∫‰∏ä‰∏çÂèØËÉΩÈÄâÊã© CA Êû∂ÊûÑ„ÄÇ</code></p>
<ul>
<li>CPÔºöÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºå<code>‰∏∫‰∫Ü‰øùËØÅ‰∏ÄËá¥ÊÄß</code>ÔºåÂΩìÂèëÁîüÂàÜÂå∫Áé∞Ë±°ÂêéÔºåN1 ËäÇÁÇπ‰∏äÁöÑÊï∞ÊçÆÂ∑≤ÁªèÊõ¥Êñ∞Âà∞ yÔºå‰ΩÜÁî±‰∫é N1 Âíå N2 ‰πãÈó¥ÁöÑÂ§çÂà∂ÈÄöÈÅì‰∏≠Êñ≠ÔºåÊï∞ÊçÆ y Êó†Ê≥ïÂêåÊ≠•Âà∞ N2ÔºåN2 ËäÇÁÇπ‰∏äÁöÑÊï∞ÊçÆËøòÊòØ x„ÄÇ<code>ËøôÊó∂ÂÆ¢Êà∑Á´Ø C ËÆøÈóÆ N2 Êó∂ÔºåN2 ÈúÄË¶ÅËøîÂõû ErrorÔºåÊèêÁ§∫ÂÆ¢Êà∑Á´Ø C‚ÄúÁ≥ªÁªüÁé∞Âú®ÂèëÁîü‰∫ÜÈîôËØØ‚ÄùÔºå</code>ËøôÁßçÂ§ÑÁêÜÊñπÂºè<code>ËøùËÉå‰∫ÜÂèØÁî®ÊÄß</code>ÔºàAvailabilityÔºâÁöÑË¶ÅÊ±ÇÔºåÂõ†Ê≠§ CAP ‰∏âËÄÖÂè™ËÉΩÊª°Ë∂≥ CP„ÄÇ</li>
</ul>
<p><img src="6e7d7bd54d7a4eb67918080863d354d7.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li>APÔºöÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºå<code>‰∏∫‰∫Ü‰øùËØÅÂèØÁî®ÊÄß</code>ÔºåÂΩìÂèëÁîüÂàÜÂå∫Áé∞Ë±°ÂêéÔºåN1 ËäÇÁÇπ‰∏äÁöÑÊï∞ÊçÆÂ∑≤ÁªèÊõ¥Êñ∞Âà∞ yÔºå‰ΩÜÁî±‰∫é N1 Âíå N2 ‰πãÈó¥ÁöÑÂ§çÂà∂ÈÄöÈÅì‰∏≠Êñ≠ÔºåÊï∞ÊçÆ y Êó†Ê≥ïÂêåÊ≠•Âà∞ N2ÔºåN2 ËäÇÁÇπ‰∏äÁöÑÊï∞ÊçÆËøòÊòØ x„ÄÇ<code>ËøôÊó∂ÂÆ¢Êà∑Á´Ø C ËÆøÈóÆ N2 Êó∂ÔºåN2 Â∞ÜÂΩìÂâçËá™Â∑±Êã•ÊúâÁöÑÊï∞ÊçÆ x ËøîÂõûÁªôÂÆ¢Êà∑Á´Ø C ‰∫Ü</code>ÔºåËÄåÂÆûÈôÖ‰∏äÂΩìÂâçÊúÄÊñ∞ÁöÑÊï∞ÊçÆÂ∑≤ÁªèÊòØ y ‰∫ÜÔºåËøôÂ∞±<code>‰∏çÊª°Ë∂≥‰∏ÄËá¥ÊÄß</code>ÔºàConsistencyÔºâÁöÑË¶ÅÊ±Ç‰∫ÜÔºåÂõ†Ê≠§ CAP ‰∏âËÄÖÂè™ËÉΩÊª°Ë∂≥ AP„ÄÇÊ≥®ÊÑèÔºöËøôÈáå N2 ËäÇÁÇπËøîÂõû xÔºåËôΩÁÑ∂‰∏çÊòØ‰∏Ä‰∏™‚ÄúÊ≠£Á°Æ‚ÄùÁöÑÁªìÊûúÔºå‰ΩÜÊòØ‰∏Ä‰∏™‚ÄúÂêàÁêÜ‚ÄùÁöÑÁªìÊûúÔºåÂõ†‰∏∫ x ÊòØÊóßÁöÑÊï∞ÊçÆÔºåÂπ∂‰∏çÊòØ‰∏Ä‰∏™Èîô‰π±ÁöÑÂÄºÔºåÂè™ÊòØ‰∏çÊòØÊúÄÊñ∞ÁöÑÊï∞ÊçÆËÄåÂ∑≤„ÄÇ</li>
</ul>
</li>
</ul>
<p><img src="2ccafe41de9bd7f8dec4658f004310d6.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li><p>CAP ÁêÜËÆ∫‰∏≠ÁöÑ <code>C Âú®ÂÆûË∑µ‰∏≠ÊòØ‰∏çÂèØËÉΩÂÆåÁæéÂÆûÁé∞ÁöÑ</code>ÔºåÂú®Êï∞ÊçÆÂ§çÂà∂ÁöÑËøáÁ®ã‰∏≠ÔºåËäÇÁÇπN1 ÂíåËäÇÁÇπ N2 ÁöÑÊï∞ÊçÆÂπ∂‰∏ç‰∏ÄËá¥ÔºàÂº∫‰∏ÄËá¥ÊÄßÔºâ„ÄÇÂç≥‰ΩøÊó†Ê≥ïÂÅöÂà∞<code>Âº∫‰∏ÄËá¥ÊÄß</code>Ôºå‰ΩÜÂ∫îÁî®ÂèØ‰ª•ÈááÁî®ÈÄÇÂêàÁöÑÊñπÂºèËææÂà∞<code>ÊúÄÁªà‰∏ÄËá¥ÊÄß</code>„ÄÇÂÖ∑ÊúâÂ¶Ç‰∏ãÁâπÁÇπÔºö</p>
<ul>
<li>Âü∫Êú¨ÂèØÁî®ÔºàBasically AvailableÔºâÔºöÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂú®Âá∫Áé∞ÊïÖÈöúÊó∂ÔºåÂÖÅËÆ∏ÊçüÂ§±ÈÉ®ÂàÜÂèØÁî®ÊÄßÔºåÂç≥‰øùËØÅÊ†∏ÂøÉÂèØÁî®„ÄÇ</li>
<li>ËΩØÁä∂ÊÄÅÔºàSoft StateÔºâÔºöÂÖÅËÆ∏Á≥ªÁªüÂ≠òÂú®‰∏≠Èó¥Áä∂ÊÄÅÔºåËÄåËØ•‰∏≠Èó¥Áä∂ÊÄÅ‰∏ç‰ºöÂΩ±ÂìçÁ≥ªÁªüÊï¥‰ΩìÂèØÁî®ÊÄß„ÄÇËøôÈáåÁöÑ‰∏≠Èó¥Áä∂ÊÄÅÂ∞±ÊòØ CAP ÁêÜËÆ∫‰∏≠ÁöÑÊï∞ÊçÆ‰∏ç‰∏ÄËá¥„ÄÇ</li>
<li><code>ÊúÄÁªà‰∏ÄËá¥ÊÄßÔºàEventual ConsistencyÔºâÔºöÁ≥ªÁªü‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆÂâØÊú¨ÁªèËøá‰∏ÄÂÆöÊó∂Èó¥ÂêéÔºåÊúÄÁªàËÉΩÂ§üËææÂà∞‰∏ÄËá¥ÁöÑÁä∂ÊÄÅ„ÄÇ</code></li>
</ul>
</li>
</ul>
<h2 id="2„ÄÅÊï∞ÊçÆÂ∫ìÂàÜÁâáÊû∂ÊûÑ"><a href="#2„ÄÅÊï∞ÊçÆÂ∫ìÂàÜÁâáÊû∂ÊûÑ" class="headerlink" title="2„ÄÅÊï∞ÊçÆÂ∫ìÂàÜÁâáÊû∂ÊûÑ"></a>2„ÄÅÊï∞ÊçÆÂ∫ìÂàÜÁâáÊû∂ÊûÑ</h2><p><strong>ËØªÂÜôÂàÜÁ¶ªÁöÑÈóÆÈ¢òÔºö</strong></p>
<p>ËØªÂÜôÂàÜÁ¶ªÂàÜÊï£‰∫ÜÊï∞ÊçÆÂ∫ìËØªÂÜôÊìç‰ΩúÁöÑÂéãÂäõÔºå‰ΩÜÊ≤°ÊúâÂàÜÊï£Â≠òÂÇ®ÂéãÂäõÔºå‰∏∫‰∫ÜÊª°Ë∂≥‰∏öÂä°Êï∞ÊçÆÂ≠òÂÇ®ÁöÑÈúÄÊ±ÇÔºåÂ∞±ÈúÄË¶Å<code>Â∞ÜÂ≠òÂÇ®ÂàÜÊï£Âà∞Â§öÂè∞Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®‰∏ä</code>„ÄÇ</p>
<p><strong>Êï∞ÊçÆÂàÜÁâáÔºö</strong></p>
<p>Â∞ÜÂ≠òÊîæÂú®Âçï‰∏ÄÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÂàÜÊï£Âú∞Â≠òÊîæËá≥Â§ö‰∏™Êï∞ÊçÆÂ∫ìÊàñË°®‰∏≠Ôºå‰ª•ËææÂà∞ÊèêÂçáÊÄßËÉΩÁì∂È¢à‰ª•ÂèäÂèØÁî®ÊÄßÁöÑÊïàÊûú„ÄÇ Êï∞ÊçÆÂàÜÁâáÁöÑÊúâÊïàÊâãÊÆµÊòØÂØπÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìËøõË°å<code>ÂàÜÂ∫ìÂíåÂàÜË°®</code>„ÄÇÊï∞ÊçÆÂàÜÁâáÁöÑÊãÜÂàÜÊñπÂºèÂèàÂàÜ‰∏∫<code>ÂûÇÁõ¥ÂàÜÁâáÂíåÊ∞¥Âπ≥ÂàÜÁâá</code>„ÄÇ</p>
<h3 id="2-1„ÄÅÂûÇÁõ¥ÂàÜÁâá"><a href="#2-1„ÄÅÂûÇÁõ¥ÂàÜÁâá" class="headerlink" title="2.1„ÄÅÂûÇÁõ¥ÂàÜÁâá"></a>2.1„ÄÅÂûÇÁõ¥ÂàÜÁâá</h3><p><strong>ÂûÇÁõ¥ÂàÜÂ∫ìÔºö</strong></p>
<p><code>ÊåâÁÖß‰∏öÂä°ÊãÜÂàÜÁöÑÊñπÂºèÁß∞‰∏∫ÂûÇÁõ¥ÂàÜÁâáÔºåÂèàÁß∞‰∏∫Á∫µÂêëÊãÜÂàÜ</code>ÔºåÂÆÉÁöÑÊ†∏ÂøÉÁêÜÂøµÊòØ‰∏ìÂ∫ì‰∏ìÁî®„ÄÇ Âú®ÊãÜÂàÜ‰πãÂâçÔºå‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÁî±Â§ö‰∏™Êï∞ÊçÆË°®ÊûÑÊàêÔºåÊØè‰∏™Ë°®ÂØπÂ∫îÁùÄ‰∏çÂêåÁöÑ‰∏öÂä°„ÄÇËÄåÊãÜÂàÜ‰πãÂêéÔºåÂàôÊòØÊåâÁÖß‰∏öÂä°Â∞ÜË°®ËøõË°åÂΩíÁ±ªÔºåÂàÜÂ∏ÉÂà∞‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ì‰∏≠Ôºå‰ªéËÄåÂ∞ÜÂéãÂäõÂàÜÊï£Ëá≥‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ </p>
<p><img src="71f41d46cc5c0405f4d4dc944b4350c9.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>‰∏ãÂõæÂ±ïÁ§∫‰∫ÜÊ†πÊçÆ‰∏öÂä°ÈúÄË¶ÅÔºåÂ∞ÜÁî®Êà∑Ë°®ÂíåËÆ¢ÂçïË°®ÂûÇÁõ¥ÂàÜÁâáÂà∞‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÁöÑÊñπÊ°àÔºö</p>
<p><img src="image-20220804221855449.png" srcset="/img/loading.gif" lazyload alt="image-20220804221855449"></p>
<p>ÂûÇÁõ¥ÊãÜÂàÜÂèØ‰ª•ÁºìËß£Êï∞ÊçÆÈáèÂíåËÆøÈóÆÈáèÂ∏¶Êù•ÁöÑÈóÆÈ¢òÔºå‰ΩÜÊó†Ê≥ïÊ†πÊ≤ª„ÄÇ<code>Â¶ÇÊûúÂûÇÁõ¥ÊãÜÂàÜ‰πãÂêéÔºåË°®‰∏≠ÁöÑÊï∞ÊçÆÈáè‰æùÁÑ∂Ë∂ÖËøáÂçïËäÇÁÇπÊâÄËÉΩÊâøËΩΩÁöÑÈòàÂÄºÔºåÂàôÈúÄË¶ÅÊ∞¥Âπ≥ÂàÜÁâáÊù•Ëøõ‰∏ÄÊ≠•Â§ÑÁêÜ„ÄÇ</code></p>
<p><strong>ÂûÇÁõ¥ÂàÜË°®Ôºö</strong></p>
<p><code>ÂûÇÁõ¥ÂàÜË°®ÈÄÇÂêàÂ∞ÜË°®‰∏≠Êüê‰∫õ‰∏çÂ∏∏Áî®ÁöÑÂàóÔºåÊàñËÄÖÊòØÂç†‰∫ÜÂ§ßÈáèÁ©∫Èó¥ÁöÑÂàóÊãÜÂàÜÂá∫Âéª„ÄÇ</code></p>
<p>ÂÅáËÆæÊàë‰ª¨ÊòØ‰∏Ä‰∏™Â©öÊÅãÁΩëÁ´ôÔºåÁî®Êà∑Âú®Á≠õÈÄâÂÖ∂‰ªñÁî®Êà∑ÁöÑÊó∂ÂÄôÔºå‰∏ªË¶ÅÊòØÁî® age Âíå sex ‰∏§‰∏™Â≠óÊÆµËøõË°åÊü•ËØ¢ÔºåËÄå nickname Âíå description ‰∏§‰∏™Â≠óÊÆµ‰∏ªË¶ÅÁî®‰∫éÂ±ïÁ§∫Ôºå‰∏ÄËà¨‰∏ç‰ºöÂú®‰∏öÂä°Êü•ËØ¢‰∏≠Áî®Âà∞„ÄÇdescription Êú¨Ë∫´ÂèàÊØîËæÉÈïøÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Â∞ÜËøô‰∏§‰∏™Â≠óÊÆµÁã¨Á´ãÂà∞Âè¶Â§ñ‰∏ÄÂº†Ë°®‰∏≠ÔºåËøôÊ†∑Âú®Êü•ËØ¢ age Âíå sex Êó∂ÔºåÂ∞±ËÉΩÂ∏¶Êù•‰∏ÄÂÆöÁöÑÊÄßËÉΩÊèêÂçá„ÄÇ</p>
<p>ÂûÇÁõ¥ÂàÜË°®ÂºïÂÖ•ÁöÑÂ§çÊùÇÊÄß‰∏ªË¶Å‰ΩìÁé∞Âú®Ë°®Êìç‰ΩúÁöÑÊï∞ÈáèË¶ÅÂ¢ûÂä†„ÄÇ‰æãÂ¶ÇÔºåÂéüÊù•Âè™Ë¶Å‰∏ÄÊ¨°Êü•ËØ¢Â∞±ÂèØ‰ª•Ëé∑Âèñ name„ÄÅage„ÄÅsex„ÄÅnickname„ÄÅdescriptionÔºåÁé∞Âú®ÈúÄË¶Å‰∏§Ê¨°Êü•ËØ¢Ôºå‰∏ÄÊ¨°Êü•ËØ¢Ëé∑Âèñ name„ÄÅage„ÄÅsexÔºåÂè¶Â§ñ‰∏ÄÊ¨°Êü•ËØ¢Ëé∑Âèñ nickname„ÄÅdescription„ÄÇ</p>
<p><img src="136bc2f01919edcb8271df6f7e71af40.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><code>Ê∞¥Âπ≥ÂàÜË°®ÈÄÇÂêàË°®Ë°åÊï∞ÁâπÂà´Â§ßÁöÑË°®ÔºåÊ∞¥Âπ≥ÂàÜË°®Â±û‰∫éÊ∞¥Âπ≥ÂàÜÁâá</code>„ÄÇ</p>
<h3 id="2-2„ÄÅÊ∞¥Âπ≥ÂàÜÁâá"><a href="#2-2„ÄÅÊ∞¥Âπ≥ÂàÜÁâá" class="headerlink" title="2.2„ÄÅÊ∞¥Âπ≥ÂàÜÁâá"></a>2.2„ÄÅÊ∞¥Âπ≥ÂàÜÁâá</h3><p><code>Ê∞¥Âπ≥ÂàÜÁâáÂèàÁß∞‰∏∫Ê®™ÂêëÊãÜÂàÜ„ÄÇ</code> Áõ∏ÂØπ‰∫éÂûÇÁõ¥ÂàÜÁâáÔºåÂÆÉ‰∏çÂÜçÂ∞ÜÊï∞ÊçÆÊ†πÊçÆ‰∏öÂä°ÈÄªËæëÂàÜÁ±ªÔºåËÄåÊòØÈÄöËøáÊüê‰∏™Â≠óÊÆµÔºàÊàñÊüêÂá†‰∏™Â≠óÊÆµÔºâÔºåÊ†πÊçÆÊüêÁßçËßÑÂàôÂ∞ÜÊï∞ÊçÆÂàÜÊï£Ëá≥Â§ö‰∏™Â∫ìÊàñË°®‰∏≠ÔºåÊØè‰∏™ÂàÜÁâá‰ªÖÂåÖÂê´Êï∞ÊçÆÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ ‰æãÂ¶ÇÔºöÊ†πÊçÆ‰∏ªÈîÆÂàÜÁâáÔºåÂÅ∂Êï∞‰∏ªÈîÆÁöÑËÆ∞ÂΩïÊîæÂÖ• 0 Â∫ìÔºàÊàñË°®ÔºâÔºåÂ•áÊï∞‰∏ªÈîÆÁöÑËÆ∞ÂΩïÊîæÂÖ• 1 Â∫ìÔºàÊàñË°®ÔºâÔºåÂ¶Ç‰∏ãÂõæÊâÄÁ§∫„ÄÇ</p>
<p><img src="image-20220804222212087.png" srcset="/img/loading.gif" lazyload alt="image-20220804222212087"></p>
<p><code>ÂçïË°®ËøõË°åÂàáÂàÜÂêéÔºåÊòØÂê¶Â∞ÜÂ§ö‰∏™Ë°®ÂàÜÊï£Âú®‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®‰∏≠ÔºåÂèØ‰ª•Ê†πÊçÆÂÆûÈôÖÁöÑÂàáÂàÜÊïàÊûúÊù•Á°ÆÂÆö„ÄÇ</code></p>
<ul>
<li><p><strong>Ê∞¥Âπ≥ÂàÜË°®Ôºö</strong>ÂçïË°®ÂàáÂàÜ‰∏∫Â§öË°®ÂêéÔºåÊñ∞ÁöÑË°®Âç≥‰ΩøÂú®Âêå‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®‰∏≠Ôºå‰πüÂèØËÉΩÂ∏¶Êù•ÂèØËßÇÁöÑÊÄßËÉΩÊèêÂçáÔºåÂ¶ÇÊûúÊÄßËÉΩËÉΩÂ§üÊª°Ë∂≥‰∏öÂä°Ë¶ÅÊ±ÇÔºåÂèØ‰ª•‰∏çÊãÜÂàÜÂà∞Â§öÂè∞Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®ÔºåÊØïÁ´ü‰∏öÂä°ÂàÜÂ∫ì‰πü‰ºöÂºïÂÖ•ÂæàÂ§öÂ§çÊùÇÊÄßÔºõ</p>
</li>
<li><p><strong>Ê∞¥Âπ≥ÂàÜÂ∫ìÔºö</strong>Â¶ÇÊûúÂçïË°®ÊãÜÂàÜ‰∏∫Â§öË°®ÂêéÔºåÂçïÂè∞ÊúçÂä°Âô®‰æùÁÑ∂Êó†Ê≥ïÊª°Ë∂≥ÊÄßËÉΩË¶ÅÊ±ÇÔºåÈÇ£Â∞±ÈúÄË¶ÅÂ∞ÜÂ§ö‰∏™Ë°®ÂàÜÊï£Âú®‰∏çÂêåÁöÑÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®‰∏≠„ÄÇ</p>
</li>
</ul>
<blockquote>
<p><strong>ÈòøÈáåÂ∑¥Â∑¥JavaÂºÄÂèëÊâãÂÜåÔºö</strong></p>
<p>„ÄêÊé®Ëçê„ÄëÂçïË°®Ë°åÊï∞Ë∂ÖËøá 500 ‰∏áË°åÊàñËÄÖÂçïË°®ÂÆπÈáèË∂ÖËøá 2GBÔºåÊâçÊé®ËçêËøõË°åÂàÜÂ∫ìÂàÜË°®„ÄÇ</p>
<p>ËØ¥ÊòéÔºöÂ¶ÇÊûúÈ¢ÑËÆ°‰∏âÂπ¥ÂêéÁöÑÊï∞ÊçÆÈáèÊ†πÊú¨Ëææ‰∏çÂà∞Ëøô‰∏™Á∫ßÂà´Ôºå<code>ËØ∑‰∏çË¶ÅÂú®ÂàõÂª∫Ë°®Êó∂Â∞±ÂàÜÂ∫ìÂàÜË°®</code>„ÄÇ</p>
</blockquote>
<h2 id="3„ÄÅËØªÂÜôÂàÜÁ¶ªÂíåÊï∞ÊçÆÂàÜÁâáÊû∂ÊûÑ"><a href="#3„ÄÅËØªÂÜôÂàÜÁ¶ªÂíåÊï∞ÊçÆÂàÜÁâáÊû∂ÊûÑ" class="headerlink" title="3„ÄÅËØªÂÜôÂàÜÁ¶ªÂíåÊï∞ÊçÆÂàÜÁâáÊû∂ÊûÑ"></a>3„ÄÅËØªÂÜôÂàÜÁ¶ªÂíåÊï∞ÊçÆÂàÜÁâáÊû∂ÊûÑ</h2><p> ‰∏ãÂõæÂ±ïÁé∞‰∫ÜÂ∞ÜÊï∞ÊçÆÂàÜÁâá‰∏éËØªÂÜôÂàÜÁ¶ª‰∏ÄÂêå‰ΩøÁî®Êó∂ÔºåÂ∫îÁî®Á®ãÂ∫è‰∏éÊï∞ÊçÆÂ∫ìÈõÜÁæ§‰πãÈó¥ÁöÑÂ§çÊùÇÊãìÊâëÂÖ≥Á≥ª„ÄÇ</p>
<p><img src="image-20220804223321167.png" srcset="/img/loading.gif" lazyload alt="image-20220804223321167"></p>
<h2 id="4„ÄÅÂÆûÁé∞ÊñπÂºè"><a href="#4„ÄÅÂÆûÁé∞ÊñπÂºè" class="headerlink" title="4„ÄÅÂÆûÁé∞ÊñπÂºè"></a>4„ÄÅÂÆûÁé∞ÊñπÂºè</h2><p>ËØªÂÜôÂàÜÁ¶ªÂíåÊï∞ÊçÆÂàÜÁâáÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÊñπÂºè‰∏ÄËà¨Êúâ‰∏§ÁßçÔºö  <code>Á®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö</code>Âíå<code>‰∏≠Èó¥‰ª∂Â∞ÅË£Ö</code>„ÄÇ</p>
<h3 id="4-1„ÄÅÁ®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö"><a href="#4-1„ÄÅÁ®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö" class="headerlink" title="4.1„ÄÅÁ®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö"></a>4.1„ÄÅÁ®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö</h3><p>Á®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£ÖÊåáÂú®‰ª£Á†Å‰∏≠ÊäΩË±°‰∏Ä‰∏™<code>Êï∞ÊçÆËÆøÈóÆÂ±ÇÔºàÊàñ‰∏≠Èó¥Â±ÇÂ∞ÅË£ÖÔºâ</code>ÔºåÂÆûÁé∞ËØªÂÜôÊìç‰ΩúÂàÜÁ¶ªÂíåÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®ËøûÊé•ÁöÑÁÆ°ÁêÜ„ÄÇ</p>
<p><strong>ÂÖ∂Âü∫Êú¨Êû∂ÊûÑÊòØÔºö</strong>‰ª•ËØªÂÜôÂàÜÁ¶ª‰∏∫‰æã</p>
<p><img src="f8d538f9201e3ebee37dfdcd1922e9df.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="4-2„ÄÅ‰∏≠Èó¥‰ª∂Â∞ÅË£Ö"><a href="#4-2„ÄÅ‰∏≠Èó¥‰ª∂Â∞ÅË£Ö" class="headerlink" title="4.2„ÄÅ‰∏≠Èó¥‰ª∂Â∞ÅË£Ö"></a>4.2„ÄÅ‰∏≠Èó¥‰ª∂Â∞ÅË£Ö</h3><p>‰∏≠Èó¥‰ª∂Â∞ÅË£ÖÊåáÁöÑÊòØ<code>Áã¨Á´ã‰∏ÄÂ•óÁ≥ªÁªüÂá∫Êù•</code>ÔºåÂÆûÁé∞ËØªÂÜôÊìç‰ΩúÂàÜÁ¶ªÂíåÊï∞ÊçÆÂ∫ìÊúçÂä°Âô®ËøûÊé•ÁöÑÁÆ°ÁêÜ„ÄÇÂØπ‰∫é‰∏öÂä°ÊúçÂä°Âô®Êù•ËØ¥ÔºåËÆøÈóÆ‰∏≠Èó¥‰ª∂ÂíåËÆøÈóÆÊï∞ÊçÆÂ∫ìÊ≤°ÊúâÂå∫Âà´ÔºåÂú®‰∏öÂä°ÊúçÂä°Âô®ÁúãÊù•Ôºå‰∏≠Èó¥‰ª∂Â∞±ÊòØ‰∏Ä‰∏™Êï∞ÊçÆÂ∫ìÊúçÂä°Âô®„ÄÇ</p>
<p><strong>Âü∫Êú¨Êû∂ÊûÑÊòØÔºö</strong> ‰ª•ËØªÂÜôÂàÜÁ¶ª‰∏∫‰æã</p>
<p><img src="2a2dba7f07581fd055d9cd5a3aa8388e.jpg" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="4-3„ÄÅÂ∏∏Áî®Ëß£ÂÜ≥ÊñπÊ°à"><a href="#4-3„ÄÅÂ∏∏Áî®Ëß£ÂÜ≥ÊñπÊ°à" class="headerlink" title="4.3„ÄÅÂ∏∏Áî®Ëß£ÂÜ≥ÊñπÊ°à"></a>4.3„ÄÅÂ∏∏Áî®Ëß£ÂÜ≥ÊñπÊ°à</h3><p>Apache ShardingSphereÔºàÁ®ãÂ∫èÁ∫ßÂà´Âíå‰∏≠Èó¥‰ª∂Á∫ßÂà´Ôºâ</p>
<p>MyCatÔºàÊï∞ÊçÆÂ∫ì‰∏≠Èó¥‰ª∂Ôºâ </p>
<h1 id="Á¨¨02Á´†-ShardingSphere"><a href="#Á¨¨02Á´†-ShardingSphere" class="headerlink" title="Á¨¨02Á´† ShardingSphere"></a>Á¨¨02Á´† ShardingSphere</h1><h2 id="1„ÄÅÁÆÄ‰ªã"><a href="#1„ÄÅÁÆÄ‰ªã" class="headerlink" title="1„ÄÅÁÆÄ‰ªã"></a>1„ÄÅÁÆÄ‰ªã</h2><p>ÂÆòÁΩëÔºö<a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/index_zh.html">https://shardingsphere.apache.org/index_zh.html</a></p>
<p>ÊñáÊ°£Ôºö<a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/overview/">https://shardingsphere.apache.org/document/5.1.1/cn/overview/</a></p>
<p>Apache ShardingSphere Áî± JDBC„ÄÅProxy Âíå SidecarÔºàËßÑÂàí‰∏≠ÔºâËøô 3 Ê¨æÊó¢ËÉΩÂ§üÁã¨Á´ãÈÉ®ÁΩ≤ÔºåÂèàÊîØÊåÅÊ∑∑ÂêàÈÉ®ÁΩ≤ÈÖçÂêà‰ΩøÁî®ÁöÑ‰∫ßÂìÅÁªÑÊàê„ÄÇ </p>
<h2 id="2„ÄÅShardingSphere-JDBC"><a href="#2„ÄÅShardingSphere-JDBC" class="headerlink" title="2„ÄÅShardingSphere-JDBC"></a>2„ÄÅShardingSphere-JDBC</h2><p><strong>Á®ãÂ∫è‰ª£Á†ÅÂ∞ÅË£Ö</strong></p>
<p>ÂÆö‰Ωç‰∏∫ËΩªÈáèÁ∫ß Java Ê°ÜÊû∂Ôºå<code>Âú® Java ÁöÑ JDBC Â±ÇÊèê‰æõÁöÑÈ¢ùÂ§ñÊúçÂä°</code>„ÄÇ ÂÆÉ‰ΩøÁî®ÂÆ¢Êà∑Á´ØÁõ¥ËøûÊï∞ÊçÆÂ∫ìÔºå<code>‰ª• jar ÂåÖÂΩ¢ÂºèÊèê‰æõÊúçÂä°</code>ÔºåÊó†ÈúÄÈ¢ùÂ§ñÈÉ®ÁΩ≤Âíå‰æùËµñÔºåÂèØÁêÜËß£‰∏∫Â¢ûÂº∫ÁâàÁöÑ JDBC È©±Âä®ÔºåÂÆåÂÖ®ÂÖºÂÆπ JDBC ÂíåÂêÑÁßç ORM Ê°ÜÊû∂„ÄÇ</p>
<p><img src="image-20220804195402870.png" srcset="/img/loading.gif" lazyload alt="image-20220804195402870"></p>
<h2 id="3„ÄÅShardingSphere-Proxy"><a href="#3„ÄÅShardingSphere-Proxy" class="headerlink" title="3„ÄÅShardingSphere-Proxy"></a>3„ÄÅShardingSphere-Proxy</h2><p><strong>‰∏≠Èó¥‰ª∂Â∞ÅË£Ö</strong></p>
<p>ÂÆö‰Ωç‰∏∫ÈÄèÊòéÂåñÁöÑ<code>Êï∞ÊçÆÂ∫ì‰ª£ÁêÜÁ´Ø</code>ÔºåÊèê‰æõÂ∞ÅË£Ö‰∫ÜÊï∞ÊçÆÂ∫ì‰∫åËøõÂà∂ÂçèËÆÆÁöÑÊúçÂä°Á´ØÁâàÊú¨ÔºåÁî®‰∫éÂÆåÊàêÂØπÂºÇÊûÑËØ≠Ë®ÄÁöÑÊîØÊåÅ„ÄÇ ÁõÆÂâçÊèê‰æõ MySQL Âíå PostgreSQLÁâàÊú¨ÔºåÂÆÉÂèØ‰ª•‰ΩøÁî®‰ªª‰ΩïÂÖºÂÆπ MySQL&#x2F;PostgreSQL ÂçèËÆÆÁöÑËÆøÈóÆÂÆ¢Êà∑Á´ØÔºàÂ¶ÇÔºöMySQL Command Client, MySQL Workbench, Navicat Á≠âÔºâÊìç‰ΩúÊï∞ÊçÆÔºåÂØπ DBA Êõ¥Âä†ÂèãÂ•Ω„ÄÇ</p>
<p><img src="image-20220804195432673.png" srcset="/img/loading.gif" lazyload alt="image-20220804195432673"></p>
<h1 id="Á¨¨03Á´†-MySQL‰∏ª‰ªéÂêåÊ≠•"><a href="#Á¨¨03Á´†-MySQL‰∏ª‰ªéÂêåÊ≠•" class="headerlink" title="Á¨¨03Á´† MySQL‰∏ª‰ªéÂêåÊ≠•"></a>Á¨¨03Á´† MySQL‰∏ª‰ªéÂêåÊ≠•</h1><h2 id="1„ÄÅMySQL‰∏ª‰ªéÂêåÊ≠•ÂéüÁêÜ"><a href="#1„ÄÅMySQL‰∏ª‰ªéÂêåÊ≠•ÂéüÁêÜ" class="headerlink" title="1„ÄÅMySQL‰∏ª‰ªéÂêåÊ≠•ÂéüÁêÜ"></a>1„ÄÅMySQL‰∏ª‰ªéÂêåÊ≠•ÂéüÁêÜ</h2><p><img src="image-20220714133617856.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>Âü∫Êú¨ÂéüÁêÜÔºö</strong></p>
<p>slave‰ºö‰ªémasterËØªÂèñbinlogÊù•ËøõË°åÊï∞ÊçÆÂêåÊ≠•</p>
<p><strong>ÂÖ∑‰ΩìÊ≠•È™§Ôºö</strong></p>
<ul>
<li><code>step1Ôºö</code>masterÂ∞ÜÊï∞ÊçÆÊîπÂèòËÆ∞ÂΩïÂà∞<code>‰∫åËøõÂà∂Êó•ÂøóÔºàbinary logÔºâ</code>‰∏≠„ÄÇ</li>
<li><code>step2Ôºö</code> ÂΩìslave‰∏äÊâßË°å <code>start slave</code> ÂëΩ‰ª§‰πãÂêéÔºåslave‰ºöÂàõÂª∫‰∏Ä‰∏™ <code>IO Á∫øÁ®ã</code>Áî®Êù•ËøûÊé•masterÔºåËØ∑Ê±Çmaster‰∏≠ÁöÑbinlog„ÄÇ</li>
<li><code>step3Ôºö</code>ÂΩìslaveËøûÊé•masterÊó∂Ôºåmaster‰ºöÂàõÂª∫‰∏Ä‰∏™ <code>log dump Á∫øÁ®ã</code>ÔºåÁî®‰∫éÂèëÈÄÅ binlog ÁöÑÂÜÖÂÆπ„ÄÇÂú®ËØªÂèñ binlog ÁöÑÂÜÖÂÆπÁöÑÊìç‰Ωú‰∏≠Ôºå‰ºöÂØπ‰∏ªËäÇÁÇπ‰∏äÁöÑ binlog Âä†ÈîÅÔºåÂΩìËØªÂèñÂÆåÊàêÂπ∂ÂèëÈÄÅÁªô‰ªéÊúçÂä°Âô®ÂêéËß£ÈîÅ„ÄÇ</li>
<li><code>step4Ôºö</code>IO Á∫øÁ®ãÊé•Êî∂‰∏ªËäÇÁÇπ binlog dump ËøõÁ®ãÂèëÊù•ÁöÑÊõ¥Êñ∞‰πãÂêéÔºå‰øùÂ≠òÂà∞ <code>‰∏≠ÁªßÊó•ÂøóÔºàrelay logÔºâ</code> ‰∏≠„ÄÇ</li>
<li><code>step5Ôºö</code>slaveÁöÑ<code>SQLÁ∫øÁ®ã</code>ÔºåËØªÂèñrelay logÊó•ÂøóÔºåÂπ∂Ëß£ÊûêÊàêÂÖ∑‰ΩìÊìç‰ΩúÔºå‰ªéËÄåÂÆûÁé∞‰∏ª‰ªéÊìç‰Ωú‰∏ÄËá¥ÔºåÊúÄÁªàÊï∞ÊçÆ‰∏ÄËá¥„ÄÇ</li>
</ul>
<h2 id="2„ÄÅ‰∏Ä‰∏ªÂ§ö‰ªéÈÖçÁΩÆ"><a href="#2„ÄÅ‰∏Ä‰∏ªÂ§ö‰ªéÈÖçÁΩÆ" class="headerlink" title="2„ÄÅ‰∏Ä‰∏ªÂ§ö‰ªéÈÖçÁΩÆ"></a>2„ÄÅ‰∏Ä‰∏ªÂ§ö‰ªéÈÖçÁΩÆ</h2><p>ÊúçÂä°Âô®ËßÑÂàíÔºö‰ΩøÁî®<code>docker</code>ÊñπÂºèÂàõÂª∫Ôºå<code>‰∏ª‰ªéÊúçÂä°Âô®IP‰∏ÄËá¥ÔºåÁ´ØÂè£Âè∑‰∏ç‰∏ÄËá¥</code></p>
<p><img src="image-20220807183231101.png" srcset="/img/loading.gif" lazyload alt="image-20220807183231101"></p>
<ul>
<li>‰∏ªÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>atguigu-mysql-master</code>ÔºåÁ´ØÂè£<code>3306</code></li>
<li>‰ªéÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>atguigu-mysql-slave1</code>ÔºåÁ´ØÂè£<code>3307</code></li>
<li>‰ªéÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>atguigu-mysql-slave2</code>ÔºåÁ´ØÂè£<code>3308</code></li>
</ul>
<p><strong>Ê≥®ÊÑèÔºö</strong>Â¶ÇÊûúÊ≠§Êó∂Èò≤ÁÅ´Â¢ôÊòØÂºÄÂêØÁöÑÔºå<code>ÂàôÂÖàÂÖ≥Èó≠Èò≤ÁÅ´Â¢ôÔºåÂπ∂ÈáçÂêØdocker</code>ÔºåÂê¶ÂàôÂêéÁª≠ÂÆâË£ÖÁöÑMySQLÊó†Ê≥ïÂêØÂä®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ÂÖ≥Èó≠docker</span><br>systemctl stop docker<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ÂÖ≥Èó≠Èò≤ÁÅ´Â¢ô</span><br>systemctl stop firewalld<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ÂêØÂä®docker</span><br>systemctl start docker<br></code></pre></td></tr></table></figure>

<h3 id="2-1„ÄÅÂáÜÂ§á‰∏ªÊúçÂä°Âô®"><a href="#2-1„ÄÅÂáÜÂ§á‰∏ªÊúçÂä°Âô®" class="headerlink" title="2.1„ÄÅÂáÜÂ§á‰∏ªÊúçÂä°Âô®"></a>2.1„ÄÅÂáÜÂ§á‰∏ªÊúçÂä°Âô®</h3><ul>
<li><strong>step1ÔºöÂú®docker‰∏≠ÂàõÂª∫Âπ∂ÂêØÂä®MySQL‰∏ªÊúçÂä°Âô®Ôºö</strong><code>Á´ØÂè£3306</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3306:3306 \<br>-v /atguigu/mysql/master/conf:/etc/mysql/conf.d \<br>-v /atguigu/mysql/master/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name atguigu-mysql-master \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step2ÔºöÂàõÂª∫MySQL‰∏ªÊúçÂä°Âô®ÈÖçÁΩÆÊñá‰ª∂Ôºö</strong></li>
</ul>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãMySQLÁöÑbinlogÊó•ÂøóÊòØËá™Âä®ÂºÄÂêØÁöÑÔºåÂèØ‰ª•ÈÄöËøáÂ¶Ç‰∏ãÈÖçÁΩÆÂÆö‰πâ‰∏Ä‰∫õÂèØÈÄâÈÖçÁΩÆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /atguigu/mysql/master/conf/my.cnf<br></code></pre></td></tr></table></figure>

<p>ÈÖçÁΩÆÂ¶Ç‰∏ãÂÜÖÂÆπ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">[mysqld]</span><br><span class="hljs-comment"># ÊúçÂä°Âô®ÂîØ‰∏ÄidÔºåÈªòËÆ§ÂÄº1</span><br><span class="hljs-attr">server-id</span>=<span class="hljs-string">1</span><br><span class="hljs-comment"># ËÆæÁΩÆÊó•ÂøóÊ†ºÂºèÔºåÈªòËÆ§ÂÄºROW</span><br><span class="hljs-attr">binlog_format</span>=<span class="hljs-string">STATEMENT</span><br><span class="hljs-comment"># ‰∫åËøõÂà∂Êó•ÂøóÂêçÔºåÈªòËÆ§binlog</span><br><span class="hljs-comment"># log-bin=binlog</span><br><span class="hljs-comment"># ËÆæÁΩÆÈúÄË¶ÅÂ§çÂà∂ÁöÑÊï∞ÊçÆÂ∫ìÔºåÈªòËÆ§Â§çÂà∂ÂÖ®ÈÉ®Êï∞ÊçÆÂ∫ì</span><br><span class="hljs-comment">#binlog-do-db=mytestdb</span><br><span class="hljs-comment"># ËÆæÁΩÆ‰∏çÈúÄË¶ÅÂ§çÂà∂ÁöÑÊï∞ÊçÆÂ∫ì</span><br><span class="hljs-comment">#binlog-ignore-db=mysql</span><br><span class="hljs-comment">#binlog-ignore-db=infomation_schema</span><br></code></pre></td></tr></table></figure>

<p>ÈáçÂêØMySQLÂÆπÂô®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart atguigu-mysql-master<br></code></pre></td></tr></table></figure>

<p><code>binlogÊ†ºÂºèËØ¥ÊòéÔºö</code></p>
<ul>
<li>binlog_format&#x3D;STATEMENTÔºöÊó•ÂøóËÆ∞ÂΩïÁöÑÊòØ‰∏ªÊú∫Êï∞ÊçÆÂ∫ìÁöÑ<code>ÂÜôÊåá‰ª§</code>ÔºåÊÄßËÉΩÈ´òÔºå‰ΩÜÊòØnow()‰πãÁ±ªÁöÑÂáΩÊï∞‰ª•ÂèäËé∑ÂèñÁ≥ªÁªüÂèÇÊï∞ÁöÑÊìç‰Ωú‰ºöÂá∫Áé∞‰∏ª‰ªéÊï∞ÊçÆ‰∏çÂêåÊ≠•ÁöÑÈóÆÈ¢ò„ÄÇ</li>
<li>binlog_format&#x3D;ROWÔºàÈªòËÆ§ÔºâÔºöÊó•ÂøóËÆ∞ÂΩïÁöÑÊòØ‰∏ªÊú∫Êï∞ÊçÆÂ∫ìÁöÑ<code>ÂÜôÂêéÁöÑÊï∞ÊçÆ</code>ÔºåÊâπÈáèÊìç‰ΩúÊó∂ÊÄßËÉΩËæÉÂ∑ÆÔºåËß£ÂÜ≥now()ÊàñËÄÖ  user()ÊàñËÄÖ  @@hostname Á≠âÊìç‰ΩúÂú®‰∏ª‰ªéÊú∫Âô®‰∏ä‰∏ç‰∏ÄËá¥ÁöÑÈóÆÈ¢ò„ÄÇ</li>
<li>binlog_format&#x3D;MIXEDÔºöÊòØ‰ª•‰∏ä‰∏§ÁßçlevelÁöÑÊ∑∑Âêà‰ΩøÁî®ÔºåÊúâÂáΩÊï∞Áî®ROWÔºåÊ≤°ÂáΩÊï∞Áî®STATEMENTÔºå‰ΩÜÊòØÊó†Ê≥ïËØÜÂà´Á≥ªÁªüÂèòÈáè</li>
</ul>
<p><code>binlog-ignore-dbÂíåbinlog-do-dbÁöÑ‰ºòÂÖàÁ∫ßÈóÆÈ¢òÔºö</code></p>
<p><img src="0.08703112216569037.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li><strong>step3Ôºö‰ΩøÁî®ÂëΩ‰ª§Ë°åÁôªÂΩïMySQL‰∏ªÊúçÂä°Âô®Ôºö</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö<span class="hljs-built_in">env</span> LANG=C.UTF-8 ÈÅøÂÖçÂÆπÂô®‰∏≠ÊòæÁ§∫‰∏≠Êñá‰π±Á†Å</span><br>docker exec -it atguigu-mysql-master env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊ†°È™åÊñπÂºè</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step4Ôºö‰∏ªÊú∫‰∏≠ÂàõÂª∫slaveÁî®Êà∑Ôºö</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- ÂàõÂª∫slaveÁî®Êà∑</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;atguigu_slave&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-comment">-- ËÆæÁΩÆÂØÜÁ†Å</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;atguigu_slave&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED <span class="hljs-keyword">WITH</span> mysql_native_password <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br><span class="hljs-comment">-- Êéà‰∫àÂ§çÂà∂ÊùÉÈôê</span><br><span class="hljs-keyword">GRANT</span> REPLICATION SLAVE <span class="hljs-keyword">ON</span> <span class="hljs-operator">*</span>.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;atguigu_slave&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><span class="hljs-comment">-- Âà∑Êñ∞ÊùÉÈôê</span><br>FLUSH PRIVILEGES;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step5Ôºö‰∏ªÊú∫‰∏≠Êü•ËØ¢masterÁä∂ÊÄÅÔºö</strong></li>
</ul>
<p>ÊâßË°åÂÆåÊ≠§Ê≠•È™§Âêé<code>‰∏çË¶ÅÂÜçÊìç‰Ωú‰∏ªÊúçÂä°Âô®MYSQL</code>ÔºåÈò≤Ê≠¢‰∏ªÊúçÂä°Âô®Áä∂ÊÄÅÂÄºÂèòÂåñ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SHOW</span> MASTER STATUS;<br></code></pre></td></tr></table></figure>

<p>ËÆ∞‰∏ã<code>File</code>Âíå<code>Position</code>ÁöÑÂÄº„ÄÇÊâßË°åÂÆåÊ≠§Ê≠•È™§Âêé‰∏çË¶ÅÂÜçÊìç‰Ωú‰∏ªÊúçÂä°Âô®MYSQLÔºåÈò≤Ê≠¢‰∏ªÊúçÂä°Âô®Áä∂ÊÄÅÂÄºÂèòÂåñ„ÄÇ</p>
<p><img src="image-20220804191852164.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="2-2„ÄÅÂáÜÂ§á‰ªéÊúçÂä°Âô®"><a href="#2-2„ÄÅÂáÜÂ§á‰ªéÊúçÂä°Âô®" class="headerlink" title="2.2„ÄÅÂáÜÂ§á‰ªéÊúçÂä°Âô®"></a>2.2„ÄÅÂáÜÂ§á‰ªéÊúçÂä°Âô®</h3><p>ÂèØ‰ª•ÈÖçÁΩÆÂ§öÂè∞‰ªéÊú∫slave1„ÄÅslave2‚Ä¶ÔºåËøôÈáå‰ª•ÈÖçÁΩÆslave1‰∏∫‰æã</p>
<ul>
<li><strong>step1ÔºöÂú®docker‰∏≠ÂàõÂª∫Âπ∂ÂêØÂä®MySQL‰ªéÊúçÂä°Âô®Ôºö</strong><code>Á´ØÂè£3307</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3307:3306 \<br>-v /atguigu/mysql/slave1/conf:/etc/mysql/conf.d \<br>-v /atguigu/mysql/slave1/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name atguigu-mysql-slave1 \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step2ÔºöÂàõÂª∫MySQL‰ªéÊúçÂä°Âô®ÈÖçÁΩÆÊñá‰ª∂Ôºö</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /atguigu/mysql/slave1/conf/my.cnf<br></code></pre></td></tr></table></figure>

<p>ÈÖçÁΩÆÂ¶Ç‰∏ãÂÜÖÂÆπÔºö</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">[mysqld]</span><br><span class="hljs-comment"># ÊúçÂä°Âô®ÂîØ‰∏ÄidÔºåÊØèÂè∞ÊúçÂä°Âô®ÁöÑidÂøÖÈ°ª‰∏çÂêåÔºåÂ¶ÇÊûúÈÖçÁΩÆÂÖ∂‰ªñ‰ªéÊú∫ÔºåÊ≥®ÊÑè‰øÆÊîπid</span><br><span class="hljs-attr">server-id</span>=<span class="hljs-string">2</span><br><span class="hljs-comment"># ‰∏≠ÁªßÊó•ÂøóÂêçÔºåÈªòËÆ§xxxxxxxxxxxx-relay-bin</span><br><span class="hljs-comment">#relay-log=relay-bin</span><br></code></pre></td></tr></table></figure>

<p>ÈáçÂêØMySQLÂÆπÂô®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart atguigu-mysql-slave1<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step3Ôºö‰ΩøÁî®ÂëΩ‰ª§Ë°åÁôªÂΩïMySQL‰ªéÊúçÂä°Âô®Ôºö</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö</span><br>docker exec -it atguigu-mysql-slave1 env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊ†°È™åÊñπÂºè</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>step4ÔºöÂú®‰ªéÊú∫‰∏äÈÖçÁΩÆ‰∏ª‰ªéÂÖ≥Á≥ªÔºö</strong></li>
</ul>
<p>Âú®<strong>‰ªéÊú∫</strong>‰∏äÊâßË°å‰ª•‰∏ãSQLÊìç‰Ωú</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql">CHANGE MASTER <span class="hljs-keyword">TO</span> MASTER_HOST<span class="hljs-operator">=</span><span class="hljs-string">&#x27;192.168.100.201&#x27;</span>, <br>MASTER_USER<span class="hljs-operator">=</span><span class="hljs-string">&#x27;atguigu_slave&#x27;</span>,MASTER_PASSWORD<span class="hljs-operator">=</span><span class="hljs-string">&#x27;123456&#x27;</span>, MASTER_PORT<span class="hljs-operator">=</span><span class="hljs-number">3306</span>,<br>MASTER_LOG_FILE<span class="hljs-operator">=</span><span class="hljs-string">&#x27;binlog.000003&#x27;</span>,MASTER_LOG_POS<span class="hljs-operator">=</span><span class="hljs-number">1357</span>; <br></code></pre></td></tr></table></figure>

<h3 id="2-3„ÄÅÂêØÂä®‰∏ª‰ªéÂêåÊ≠•"><a href="#2-3„ÄÅÂêØÂä®‰∏ª‰ªéÂêåÊ≠•" class="headerlink" title="2.3„ÄÅÂêØÂä®‰∏ª‰ªéÂêåÊ≠•"></a>2.3„ÄÅÂêØÂä®‰∏ª‰ªéÂêåÊ≠•</h3><p>ÂêØÂä®‰ªéÊú∫ÁöÑÂ§çÂà∂ÂäüËÉΩÔºåÊâßË°åSQLÔºö</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">START</span> SLAVE;<br><span class="hljs-comment">-- Êü•ÁúãÁä∂ÊÄÅÔºà‰∏çÈúÄË¶ÅÂàÜÂè∑Ôºâ</span><br><span class="hljs-keyword">SHOW</span> SLAVE STATUS\G<br></code></pre></td></tr></table></figure>

<p><strong>‰∏§‰∏™ÂÖ≥ÈîÆËøõÁ®ãÔºö</strong> ‰∏ãÈù¢‰∏§‰∏™ÂèÇÊï∞ÈÉΩÊòØYesÔºåÂàôËØ¥Êòé‰∏ª‰ªéÈÖçÁΩÆÊàêÂäüÔºÅ</p>
<p><img src="image-20220715000533951.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<h3 id="2-4„ÄÅÂÆûÁé∞‰∏ª‰ªéÂêåÊ≠•"><a href="#2-4„ÄÅÂÆûÁé∞‰∏ª‰ªéÂêåÊ≠•" class="headerlink" title="2.4„ÄÅÂÆûÁé∞‰∏ª‰ªéÂêåÊ≠•"></a>2.4„ÄÅÂÆûÁé∞‰∏ª‰ªéÂêåÊ≠•</h3><p>Âú®‰∏ªÊú∫‰∏≠ÊâßË°å‰ª•‰∏ãSQLÔºåÂú®‰ªéÊú∫‰∏≠Êü•ÁúãÊï∞ÊçÆÂ∫ì„ÄÅË°®ÂíåÊï∞ÊçÆÊòØÂê¶Â∑≤ÁªèË¢´ÂêåÊ≠•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE db_user;<br>USE db_user;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_user (<br> id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT,<br> uname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br> <span class="hljs-keyword">PRIMARY</span> KEY (id)<br>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user(uname) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;zhang3&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_user(uname) <span class="hljs-keyword">VALUES</span>(@<span class="hljs-variable">@hostname</span>);<br></code></pre></td></tr></table></figure>

<h3 id="2-5„ÄÅÂÅúÊ≠¢ÂíåÈáçÁΩÆ"><a href="#2-5„ÄÅÂÅúÊ≠¢ÂíåÈáçÁΩÆ" class="headerlink" title="2.5„ÄÅÂÅúÊ≠¢ÂíåÈáçÁΩÆ"></a>2.5„ÄÅÂÅúÊ≠¢ÂíåÈáçÁΩÆ</h3><p>ÈúÄË¶ÅÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•‰ΩøÁî®Â¶Ç‰∏ãSQLËØ≠Âè•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- Âú®‰ªéÊú∫‰∏äÊâßË°å„ÄÇÂäüËÉΩËØ¥ÊòéÔºöÂÅúÊ≠¢I/O Á∫øÁ®ãÂíåSQLÁ∫øÁ®ãÁöÑÊìç‰Ωú„ÄÇ</span><br>stop slave; <br><br><span class="hljs-comment">-- Âú®‰ªéÊú∫‰∏äÊâßË°å„ÄÇÂäüËÉΩËØ¥ÊòéÔºöÁî®‰∫éÂà†Èô§SLAVEÊï∞ÊçÆÂ∫ìÁöÑrelaylogÊó•ÂøóÊñá‰ª∂ÔºåÂπ∂ÈáçÊñ∞ÂêØÁî®Êñ∞ÁöÑrelaylogÊñá‰ª∂„ÄÇ</span><br>reset slave;<br><br><span class="hljs-comment">-- Âú®‰∏ªÊú∫‰∏äÊâßË°å„ÄÇÂäüËÉΩËØ¥ÊòéÔºöÂà†Èô§ÊâÄÊúâÁöÑbinglogÊó•ÂøóÊñá‰ª∂ÔºåÂπ∂Â∞ÜÊó•ÂøóÁ¥¢ÂºïÊñá‰ª∂Ê∏ÖÁ©∫ÔºåÈáçÊñ∞ÂºÄÂßãÊâÄÊúâÊñ∞ÁöÑÊó•ÂøóÊñá‰ª∂„ÄÇ</span><br><span class="hljs-comment">-- Áî®‰∫éÁ¨¨‰∏ÄÊ¨°ËøõË°åÊê≠Âª∫‰∏ª‰ªéÂ∫ìÊó∂ÔºåËøõË°å‰∏ªÂ∫ìbinlogÂàùÂßãÂåñÂ∑•‰ΩúÔºõ</span><br>reset master;<br></code></pre></td></tr></table></figure>

<h3 id="2-6„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò"><a href="#2-6„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò" class="headerlink" title="2.6„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò"></a><strong>2.6„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò</strong></h3><h4 id="ÈóÆÈ¢ò1"><a href="#ÈóÆÈ¢ò1" class="headerlink" title="ÈóÆÈ¢ò1"></a>ÈóÆÈ¢ò1</h4><p>ÂêØÂä®‰∏ª‰ªéÂêåÊ≠•ÂêéÔºåÂ∏∏ËßÅÈîôËØØÊòØ<code>Slave_IO_RunningÔºö No ÊàñËÄÖ Connecting</code> ÁöÑÊÉÖÂÜµÔºåÊ≠§Êó∂Êü•Áúã‰∏ãÊñπÁöÑ <code>Last_IO_ERROR</code>ÈîôËØØÊó•ÂøóÔºåÊ†πÊçÆÊó•Âøó‰∏≠ÊòæÁ§∫ÁöÑÈîôËØØ‰ø°ÊÅØÂú®ÁΩë‰∏äÊêúÁ¥¢Ëß£ÂÜ≥ÊñπÊ°àÂç≥ÂèØ</p>
<p><img src="image-20220714235426120.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p><strong>ÂÖ∏ÂûãÁöÑÈîôËØØ‰æãÂ¶ÇÔºö</strong><code>Last_IO_Error: Got fatal error 1236 from master when reading data from binary log: &#39;Client requested master to start replication from position &gt; file size&#39;</code></p>
<p><strong>Ëß£ÂÜ≥ÊñπÊ°àÔºö</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- Âú®‰ªéÊú∫ÂÅúÊ≠¢slave</span><br>SLAVE STOP;<br><br><span class="hljs-comment">-- Âú®‰∏ªÊú∫Êü•ÁúãmaterÁä∂ÊÄÅ</span><br><span class="hljs-keyword">SHOW</span> MASTER STATUS;<br><span class="hljs-comment">-- Âú®‰∏ªÊú∫Âà∑Êñ∞Êó•Âøó</span><br>FLUSH LOGS;<br><span class="hljs-comment">-- ÂÜçÊ¨°Âú®‰∏ªÊú∫Êü•ÁúãmaterÁä∂ÊÄÅÔºà‰ºöÂèëÁé∞FileÂíåPositionÂèëÁîü‰∫ÜÂèòÂåñÔºâ</span><br><span class="hljs-keyword">SHOW</span> MASTER STATUS;<br><span class="hljs-comment">-- ‰øÆÊîπ‰ªéÊú∫ËøûÊé•‰∏ªÊú∫ÁöÑSQLÔºåÂπ∂ÈáçÊñ∞ËøûÊé•Âç≥ÂèØ</span><br></code></pre></td></tr></table></figure>

<h4 id="ÈóÆÈ¢ò2"><a href="#ÈóÆÈ¢ò2" class="headerlink" title="ÈóÆÈ¢ò2"></a>ÈóÆÈ¢ò2</h4><p>ÂêØÂä®dockerÂÆπÂô®ÂêéÊèêÁ§∫ <code>WARNING: IPv4 forwarding is disabled. Networking will not work.</code></p>
<p><img src="image-20220715004850504.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<p>Ê≠§ÈîôËØØÔºåËôΩÁÑ∂‰∏çÂΩ±Âìç‰∏ª‰ªéÂêåÊ≠•ÁöÑÊê≠Âª∫Ôºå‰ΩÜÊòØÂ¶ÇÊûúÊÉ≥‰ªéËøúÁ®ãÂÆ¢Êà∑Á´ØÈÄöËøá‰ª•‰∏ãÊñπÂºèËøûÊé•docker‰∏≠ÁöÑMySQLÂàôÊ≤°Ê≥ïËøûÊé•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">C:\Users\administrator&gt;mysql -h 192.168.100.201 -P 3306 -u root -p<br></code></pre></td></tr></table></figure>

<p><strong>Ëß£ÂÜ≥ÊñπÊ°àÔºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Ôºö</span><br>vim /usr/lib/sysctl.d/00-system.conf<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøΩÂä†</span><br>net.ipv4.ip_forward=1<br><span class="hljs-meta prompt_">#</span><span class="language-bash">Êé•ÁùÄÈáçÂêØÁΩëÁªú</span><br>systemctl restart network<br></code></pre></td></tr></table></figure>

<h1 id="Á¨¨04Á´†-ShardingSphere-JDBCËØªÂÜôÂàÜÁ¶ª"><a href="#Á¨¨04Á´†-ShardingSphere-JDBCËØªÂÜôÂàÜÁ¶ª" class="headerlink" title="Á¨¨04Á´† ShardingSphere-JDBCËØªÂÜôÂàÜÁ¶ª"></a>Á¨¨04Á´† ShardingSphere-JDBCËØªÂÜôÂàÜÁ¶ª</h1><h2 id="1„ÄÅÂàõÂª∫SpringBootÁ®ãÂ∫è"><a href="#1„ÄÅÂàõÂª∫SpringBootÁ®ãÂ∫è" class="headerlink" title="1„ÄÅÂàõÂª∫SpringBootÁ®ãÂ∫è"></a>1„ÄÅÂàõÂª∫SpringBootÁ®ãÂ∫è</h2><h3 id="1-1„ÄÅÂàõÂª∫È°πÁõÆ"><a href="#1-1„ÄÅÂàõÂª∫È°πÁõÆ" class="headerlink" title="1.1„ÄÅÂàõÂª∫È°πÁõÆ"></a>1.1„ÄÅÂàõÂª∫È°πÁõÆ</h3><p>È°πÁõÆÁ±ªÂûãÔºöSpring Initializr</p>
<p>SpringBootËÑöÊâãÊû∂Ôºö<a target="_blank" rel="noopener" href="http://start.aliyun.com/">http://start.aliyun.com</a></p>
<p>È°πÁõÆÂêçÔºösharding-jdbc-demo</p>
<p>SpringBootÁâàÊú¨Ôºö2.3.7.RELEASE</p>
<h3 id="1-2„ÄÅÊ∑ªÂä†‰æùËµñ"><a href="#1-2„ÄÅÊ∑ªÂä†‰æùËµñ" class="headerlink" title="1.2„ÄÅÊ∑ªÂä†‰æùËµñ"></a>1.2„ÄÅÊ∑ªÂä†‰æùËµñ</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>shardingsphere-jdbc-core-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="1-3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"><a href="#1-3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª" class="headerlink" title="1.3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"></a>1.3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.entity;<br><br><span class="hljs-meta">@TableName(&quot;t_user&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-comment">//Âú®Áî®Êà∑ÂàõÂª∫userÊó∂Ê≤°ÊúâÂàõÂª∫idÔºåÂú®ÂÜôÂÖ•Êï∞ÊçÆÂ∫ìÊó∂‰ºöÁî®Âà∞Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰∏ªÈîÆËá™Â¢ûÁ≠ñÁï•</span><br>    <span class="hljs-comment">//</span><br>    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String uname;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="1-4„ÄÅÂàõÂª∫Mapper"><a href="#1-4„ÄÅÂàõÂª∫Mapper" class="headerlink" title="1.4„ÄÅÂàõÂª∫Mapper"></a>1.4„ÄÅÂàõÂª∫Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="1-5„ÄÅÈÖçÁΩÆËØªÂÜôÂàÜÁ¶ª"><a href="#1-5„ÄÅÈÖçÁΩÆËØªÂÜôÂàÜÁ¶ª" class="headerlink" title="1.5„ÄÅÈÖçÁΩÆËØªÂÜôÂàÜÁ¶ª"></a>1.5„ÄÅÈÖçÁΩÆËØªÂÜôÂàÜÁ¶ª</h3><p>application.propertiesÔºö</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># Â∫îÁî®ÂêçÁß∞</span><br><span class="hljs-attr">spring.application.name</span>=<span class="hljs-string">sharging-jdbc-demo</span><br><span class="hljs-comment"># ÂºÄÂèëÁéØÂ¢ÉËÆæÁΩÆ</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-comment"># ÂÜÖÂ≠òÊ®°Âºè</span><br><span class="hljs-attr">spring.shardingsphere.mode.type</span>=<span class="hljs-string">Memory</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁúüÂÆûÊï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.names</span>=<span class="hljs-string">master,slave1,slave2</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 1 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.master.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.master.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.master.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3306/db_user</span><br><span class="hljs-attr">spring.shardingsphere.datasource.master.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.master.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 2 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave1.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave1.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave1.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3307/db_user</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave1.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave1.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 3 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave2.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave2.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave2.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3308/db_user</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave2.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.slave2.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ËØªÂÜôÂàÜÁ¶ªÁ±ªÂûãÔºåÂ¶Ç: StaticÔºåDynamic</span><br><span class="hljs-comment"># mydsÊòØÊï∞ÊçÆÊ∫êÂêçÁß∞ÔºåstaticË°®Á§∫‰∏äÈù¢jdbc-urlÊòØÈùôÊÄÅÁöÑ</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.type</span>=<span class="hljs-string">Static</span><br><span class="hljs-comment"># ÂÜôÊï∞ÊçÆÊ∫êÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.props.write-data-source-name</span>=<span class="hljs-string">master</span><br><span class="hljs-comment"># ËØªÊï∞ÊçÆÊ∫êÂêçÁß∞ÔºåÂ§ö‰∏™‰ªéÊï∞ÊçÆÊ∫êÁî®ÈÄóÂè∑ÂàÜÈöî</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.props.read-data-source-names</span>=<span class="hljs-string">slave1,slave2</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÂêçÁß∞Ôºåalg_roundËΩÆËØ¢ÁÆóÊ≥ï</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.data-sources.myds.load-balancer-name</span>=<span class="hljs-string">alg_round</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÈÖçÁΩÆ</span><br><span class="hljs-comment"># Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÁ±ªÂûã</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_round.type</span>=<span class="hljs-string">ROUND_ROBIN</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_random.type</span>=<span class="hljs-string">RANDOM</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.type</span>=<span class="hljs-string">WEIGHT</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.props.slave1</span>=<span class="hljs-string">1</span><br><span class="hljs-attr">spring.shardingsphere.rules.readwrite-splitting.load-balancers.alg_weight.props.slave2</span>=<span class="hljs-string">2</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÊâìÂç∞SQl</span><br><span class="hljs-attr">spring.shardingsphere.props.sql-show</span>=<span class="hljs-string">true</span><br></code></pre></td></tr></table></figure>
<h2 id="2„ÄÅÊµãËØï"><a href="#2„ÄÅÊµãËØï" class="headerlink" title="2„ÄÅÊµãËØï"></a>2„ÄÅÊµãËØï</h2><h3 id="2-1„ÄÅËØªÂÜôÂàÜÁ¶ªÊµãËØï"><a href="#2-1„ÄÅËØªÂÜôÂàÜÁ¶ªÊµãËØï" class="headerlink" title="2.1„ÄÅËØªÂÜôÂàÜÁ¶ªÊµãËØï"></a>2.1„ÄÅËØªÂÜôÂàÜÁ¶ªÊµãËØï</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ReadwriteTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÂÜôÂÖ•Êï∞ÊçÆÁöÑÊµãËØï</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsert</span><span class="hljs-params">()</span>&#123;<br><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUname(<span class="hljs-string">&quot;Âº†‰∏â‰∏∞&quot;</span>);<br>        userMapper.insert(user);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2-2„ÄÅ‰∫ãÂä°ÊµãËØï"><a href="#2-2„ÄÅ‰∫ãÂä°ÊµãËØï" class="headerlink" title="2.2„ÄÅ‰∫ãÂä°ÊµãËØï"></a>2.2„ÄÅ‰∫ãÂä°ÊµãËØï</h3><p>‰∏∫‰∫Ü‰øùËØÅ‰∏ª‰ªéÂ∫ìÈó¥ÁöÑ‰∫ãÂä°‰∏ÄËá¥ÊÄßÔºåÈÅøÂÖçË∑®ÊúçÂä°ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÔºåShardingSphere-JDBCÁöÑ<code>‰∏ª‰ªéÊ®°Âûã‰∏≠Ôºå‰∫ãÂä°‰∏≠ÁöÑÊï∞ÊçÆËØªÂÜôÂùáÁî®‰∏ªÂ∫ì</code>„ÄÇ</p>
<ul>
<li>‰∏çÊ∑ªÂä†@TransactionalÔºöinsertÂØπ‰∏ªÂ∫ìÊìç‰ΩúÔºåselectÂØπ‰ªéÂ∫ìÊìç‰Ωú</li>
<li>Ê∑ªÂä†@TransactionalÔºöÂàôinsertÂíåselectÂùáÂØπ‰∏ªÂ∫ìÊìç‰Ωú</li>
<li><strong>Ê≥®ÊÑèÔºö</strong>Âú®JUnitÁéØÂ¢É‰∏ãÁöÑ@TransactionalÊ≥®Ëß£ÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÂ∞±‰ºöÂØπ‰∫ãÂä°ËøõË°åÂõûÊªöÔºàÂç≥‰ΩøÂú®Ê≤°Âä†Ê≥®Ëß£@RollbackÔºå‰πü‰ºöÂØπ‰∫ãÂä°ÂõûÊªöÔºâ</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ‰∫ãÂä°ÊµãËØï</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Transactional</span><span class="hljs-comment">//ÂºÄÂêØ‰∫ãÂä°</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testTrans</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>    user.setUname(<span class="hljs-string">&quot;ÈìÅÈî§&quot;</span>);<br>    userMapper.insert(user);<br><br>    List&lt;User&gt; users = userMapper.selectList(<span class="hljs-literal">null</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2-3„ÄÅË¥üËΩΩÂùáË°°ÊµãËØï"><a href="#2-3„ÄÅË¥üËΩΩÂùáË°°ÊµãËØï" class="headerlink" title="2.3„ÄÅË¥üËΩΩÂùáË°°ÊµãËØï"></a>2.3„ÄÅË¥üËΩΩÂùáË°°ÊµãËØï</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ËØªÊï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSelectAll</span><span class="hljs-params">()</span>&#123;<br>    List&lt;User&gt; users = userMapper.selectList(<span class="hljs-literal">null</span>);<br>    List&lt;User&gt; users = userMapper.selectList(<span class="hljs-literal">null</span>);<span class="hljs-comment">//ÊâßË°åÁ¨¨‰∫åÊ¨°ÊµãËØïË¥üËΩΩÂùáË°°</span><br>    users.forEach(System.out::println);<br>&#125;<br><br></code></pre></td></tr></table></figure>
<p>‰πüÂèØ‰ª•Âú®webËØ∑Ê±Ç‰∏≠ÊµãËØïË¥üËΩΩÂùáË°°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.controller;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RequestMapping(&quot;/userController&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÊµãËØïË¥üËΩΩÂùáË°°Á≠ñÁï•</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@GetMapping(&quot;selectAll&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">selectAll</span><span class="hljs-params">()</span>&#123;<br>        List&lt;User&gt; users = userMapper.selectList(<span class="hljs-literal">null</span>);<br>        users.forEach(System.out::println);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="Á¨¨05Á´†-ShardingSphere-JDBCÂûÇÁõ¥ÂàÜÁâá"><a href="#Á¨¨05Á´†-ShardingSphere-JDBCÂûÇÁõ¥ÂàÜÁâá" class="headerlink" title="Á¨¨05Á´† ShardingSphere-JDBCÂûÇÁõ¥ÂàÜÁâá"></a>Á¨¨05Á´† ShardingSphere-JDBCÂûÇÁõ¥ÂàÜÁâá</h1><h2 id="1„ÄÅÂáÜÂ§áÊúçÂä°Âô®"><a href="#1„ÄÅÂáÜÂ§áÊúçÂä°Âô®" class="headerlink" title="1„ÄÅÂáÜÂ§áÊúçÂä°Âô®"></a>1„ÄÅÂáÜÂ§áÊúçÂä°Âô®</h2><p>ÊúçÂä°Âô®ËßÑÂàíÔºö‰ΩøÁî®<code>docker</code>ÊñπÂºèÂàõÂª∫Â¶Ç‰∏ãÂÆπÂô®</p>
<p><img src="image-20220807232456342.png" srcset="/img/loading.gif" lazyload alt="image-20220807232456342"></p>
<ul>
<li><p>ÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>server-user</code>ÔºåÁ´ØÂè£<code>3301</code></p>
</li>
<li><p>ÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>server-order</code>ÔºåÁ´ØÂè£<code>3302</code></p>
</li>
</ul>
<h3 id="1-1„ÄÅÂàõÂª∫server-userÂÆπÂô®"><a href="#1-1„ÄÅÂàõÂª∫server-userÂÆπÂô®" class="headerlink" title="1.1„ÄÅÂàõÂª∫server-userÂÆπÂô®"></a>1.1„ÄÅÂàõÂª∫server-userÂÆπÂô®</h3><ul>
<li><strong>step1ÔºöÂàõÂª∫ÂÆπÂô®Ôºö</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3301:3306 \<br>-v /atguigu/server/user/conf:/etc/mysql/conf.d \<br>-v /atguigu/server/user/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name server-user \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>step2ÔºöÁôªÂΩïMySQLÊúçÂä°Âô®Ôºö</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö</span><br>docker exec -it server-user env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊèí‰ª∂</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>step3ÔºöÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºö</strong></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE db_user;<br>USE db_user;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_user (<br> id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT,<br> uname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br> <span class="hljs-keyword">PRIMARY</span> KEY (id)<br>);<br></code></pre></td></tr></table></figure>
<h3 id="1-2„ÄÅÂàõÂª∫server-orderÂÆπÂô®"><a href="#1-2„ÄÅÂàõÂª∫server-orderÂÆπÂô®" class="headerlink" title="1.2„ÄÅÂàõÂª∫server-orderÂÆπÂô®"></a>1.2„ÄÅÂàõÂª∫server-orderÂÆπÂô®</h3><ul>
<li><p><strong>step1ÔºöÂàõÂª∫ÂÆπÂô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3302:3306 \<br>-v /atguigu/server/order/conf:/etc/mysql/conf.d \<br>-v /atguigu/server/order/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name server-order \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step2ÔºöÁôªÂΩïMySQLÊúçÂä°Âô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö</span><br>docker exec -it server-order env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊèí‰ª∂</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step3ÔºöÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºö</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE db_order;<br>USE db_order;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order (<br>  id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT,<br>  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>  user_id <span class="hljs-type">BIGINT</span>,<br>  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id) <br>);<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="2„ÄÅÁ®ãÂ∫èÂÆûÁé∞"><a href="#2„ÄÅÁ®ãÂ∫èÂÆûÁé∞" class="headerlink" title="2„ÄÅÁ®ãÂ∫èÂÆûÁé∞"></a>2„ÄÅÁ®ãÂ∫èÂÆûÁé∞</h2><h3 id="2-1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"><a href="#2-1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª" class="headerlink" title="2.1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"></a>2.1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.entity;<br><br><span class="hljs-meta">@TableName(&quot;t_order&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> &#123;<br>    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String orderNo;<br>    <span class="hljs-keyword">private</span> Long userId;<br>    <span class="hljs-keyword">private</span> BigDecimal amount;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2-2„ÄÅÂàõÂª∫Mapper"><a href="#2-2„ÄÅÂàõÂª∫Mapper" class="headerlink" title="2.2„ÄÅÂàõÂª∫Mapper"></a>2.2„ÄÅÂàõÂª∫Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Order&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="2-3„ÄÅÈÖçÁΩÆÂûÇÁõ¥ÂàÜÁâá"><a href="#2-3„ÄÅÈÖçÁΩÆÂûÇÁõ¥ÂàÜÁâá" class="headerlink" title="2.3„ÄÅÈÖçÁΩÆÂûÇÁõ¥ÂàÜÁâá"></a>2.3„ÄÅÈÖçÁΩÆÂûÇÁõ¥ÂàÜÁâá</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># Â∫îÁî®ÂêçÁß∞</span><br><span class="hljs-attr">spring.application.name</span>=<span class="hljs-string">sharding-jdbc-demo</span><br><span class="hljs-comment"># ÁéØÂ¢ÉËÆæÁΩÆ</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁúüÂÆûÊï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.names</span>=<span class="hljs-string">server-user,server-order</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 1 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3301/db_user</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 2 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3302/db_order</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># Ê†áÂáÜÂàÜÁâáË°®ÈÖçÁΩÆÔºàÊï∞ÊçÆËäÇÁÇπÔºâ</span><br><span class="hljs-comment"># spring.shardingsphere.rules.sharding.tables.&lt;table-name&gt;.actual-data-nodes=ÂÄº</span><br><span class="hljs-comment"># ÂÄºÁî±Êï∞ÊçÆÊ∫êÂêç + Ë°®ÂêçÁªÑÊàêÔºå‰ª•Â∞èÊï∞ÁÇπÂàÜÈöî„ÄÇ</span><br><span class="hljs-comment"># &lt;table-name&gt;ÔºöÈÄªËæëË°®Âêç</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes</span>=<span class="hljs-string">server-user.t_user</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes</span>=<span class="hljs-string">server-order.t_order</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÊâìÂç∞SQL</span><br><span class="hljs-attr">spring.shardingsphere.props.sql-show</span>=<span class="hljs-string">true</span><br><br></code></pre></td></tr></table></figure>
<h2 id="3„ÄÅÊµãËØïÂûÇÁõ¥ÂàÜÁâá"><a href="#3„ÄÅÊµãËØïÂûÇÁõ¥ÂàÜÁâá" class="headerlink" title="3„ÄÅÊµãËØïÂûÇÁõ¥ÂàÜÁâá"></a>3„ÄÅÊµãËØïÂûÇÁõ¥ÂàÜÁâá</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShardingTest</span> &#123;<br><br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> OrderMapper orderMapper;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÂûÇÁõ¥ÂàÜÁâáÔºöÊèíÂÖ•Êï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsertOrderAndUser</span><span class="hljs-params">()</span>&#123;<br><br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br>        user.setUname(<span class="hljs-string">&quot;Âº∫Âì•&quot;</span>);<br>        userMapper.insert(user);<br><br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU001&quot;</span>);<br>        order.setUserId(user.getId());<br>        order.setAmount(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>));<br>        orderMapper.insert(order);<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÂûÇÁõ¥ÂàÜÁâáÔºöÊü•ËØ¢Êï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSelectFromOrderAndUser</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userMapper.selectById(<span class="hljs-number">1L</span>);<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectById(<span class="hljs-number">1L</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="Â∏∏ËßÅÈîôËØØ"><a href="#Â∏∏ËßÅÈîôËØØ" class="headerlink" title="Â∏∏ËßÅÈîôËØØ"></a>Â∏∏ËßÅÈîôËØØ</h3><p><img src="image-20220810163534068.png" srcset="/img/loading.gif" lazyload alt="image-20220810163534068"></p>
<p>ShardingSphere-JDBCËøúÁ®ãËøûÊé•ÁöÑÊñπÂºèÈªòËÆ§ÁöÑÂØÜÁ†ÅÂä†ÂØÜËßÑÂàôÊòØÔºömysql_native_password</p>
<p>Âõ†Ê≠§ÈúÄË¶ÅÂú®ÊúçÂä°Âô®Á´Ø‰øÆÊîπÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÂä†ÂØÜËßÑÂàôÔºåÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED <span class="hljs-keyword">WITH</span> mysql_native_password <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h1 id="Á¨¨06Á´†-ShardingSphere-JDBCÊ∞¥Âπ≥ÂàÜÁâá"><a href="#Á¨¨06Á´†-ShardingSphere-JDBCÊ∞¥Âπ≥ÂàÜÁâá" class="headerlink" title="Á¨¨06Á´† ShardingSphere-JDBCÊ∞¥Âπ≥ÂàÜÁâá"></a>Á¨¨06Á´† ShardingSphere-JDBCÊ∞¥Âπ≥ÂàÜÁâá</h1><h2 id="1„ÄÅÂáÜÂ§áÊúçÂä°Âô®-1"><a href="#1„ÄÅÂáÜÂ§áÊúçÂä°Âô®-1" class="headerlink" title="1„ÄÅÂáÜÂ§áÊúçÂä°Âô®"></a>1„ÄÅÂáÜÂ§áÊúçÂä°Âô®</h2><p>ÊúçÂä°Âô®ËßÑÂàíÔºö‰ΩøÁî®<code>docker</code>ÊñπÂºèÂàõÂª∫Â¶Ç‰∏ãÂÆπÂô®</p>
<p><img src="image-20220808033239206.png" srcset="/img/loading.gif" lazyload alt="image-20220808033239206"></p>
<ul>
<li><p>ÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>server-order0</code>ÔºåÁ´ØÂè£<code>3310</code></p>
</li>
<li><p>ÊúçÂä°Âô®ÔºöÂÆπÂô®Âêç<code>server-order1</code>ÔºåÁ´ØÂè£<code>3311</code></p>
</li>
</ul>
<h3 id="1-1„ÄÅÂàõÂª∫server-order0ÂÆπÂô®"><a href="#1-1„ÄÅÂàõÂª∫server-order0ÂÆπÂô®" class="headerlink" title="1.1„ÄÅÂàõÂª∫server-order0ÂÆπÂô®"></a>1.1„ÄÅÂàõÂª∫server-order0ÂÆπÂô®</h3><ul>
<li><p><strong>step1ÔºöÂàõÂª∫ÂÆπÂô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3310:3306 \<br>-v /atguigu/server/order0/conf:/etc/mysql/conf.d \<br>-v /atguigu/server/order0/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name server-order0 \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step2ÔºöÁôªÂΩïMySQLÊúçÂä°Âô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö</span><br>docker exec -it server-order0 env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊèí‰ª∂</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step3ÔºöÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºö</strong><br><code>Ê≥®ÊÑèÔºö</code>Ê∞¥Âπ≥ÂàÜÁâáÁöÑidÈúÄË¶ÅÂú®‰∏öÂä°Â±ÇÂÆûÁé∞Ôºå<code>‰∏çËÉΩ‰æùËµñÊï∞ÊçÆÂ∫ìÁöÑ‰∏ªÈîÆËá™Â¢û</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE db_order;<br>USE db_order;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order0 (<br>  id <span class="hljs-type">BIGINT</span>,<br>  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>  user_id <span class="hljs-type">BIGINT</span>,<br>  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id) <br>);<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order1 (<br>  id <span class="hljs-type">BIGINT</span>,<br>  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>  user_id <span class="hljs-type">BIGINT</span>,<br>  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id) <br>);<br></code></pre></td></tr></table></figure></li>
</ul>
<h3 id="1-2„ÄÅÂàõÂª∫server-order1ÂÆπÂô®"><a href="#1-2„ÄÅÂàõÂª∫server-order1ÂÆπÂô®" class="headerlink" title="1.2„ÄÅÂàõÂª∫server-order1ÂÆπÂô®"></a>1.2„ÄÅÂàõÂª∫server-order1ÂÆπÂô®</h3><ul>
<li><p><strong>step1ÔºöÂàõÂª∫ÂÆπÂô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-p 3311:3306 \<br>-v /atguigu/server/order1/conf:/etc/mysql/conf.d \<br>-v /atguigu/server/order1/data:/var/lib/mysql \<br>-e MYSQL_ROOT_PASSWORD=123456 \<br>--name server-order1 \<br>mysql:8.0.29<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step2ÔºöÁôªÂΩïMySQLÊúçÂä°Âô®Ôºö</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®Ôºö</span><br>docker exec -it server-order1 env LANG=C.UTF-8 /bin/bash<br><span class="hljs-meta prompt_">#</span><span class="language-bash">ËøõÂÖ•ÂÆπÂô®ÂÜÖÁöÑmysqlÂëΩ‰ª§Ë°å</span><br>mysql -uroot -p<br><span class="hljs-meta prompt_">#</span><span class="language-bash">‰øÆÊîπÈªòËÆ§ÂØÜÁ†ÅÊèí‰ª∂</span><br>ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;<br></code></pre></td></tr></table></figure>
</li>
<li><p><strong>step3ÔºöÂàõÂª∫Êï∞ÊçÆÂ∫ìÔºö</strong>Âíåserver-order0Áõ∏Âêå<br><code>Ê≥®ÊÑèÔºö</code>Ê∞¥Âπ≥ÂàÜÁâáÁöÑidÈúÄË¶ÅÂú®‰∏öÂä°Â±ÇÂÆûÁé∞Ôºå‰∏çËÉΩ‰æùËµñÊï∞ÊçÆÂ∫ìÁöÑ‰∏ªÈîÆËá™Â¢û</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> DATABASE db_order;<br>USE db_order;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order0 (<br>  id <span class="hljs-type">BIGINT</span>,<br>  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>  user_id <span class="hljs-type">BIGINT</span>,<br>  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id) <br>);<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order1 (<br>  id <span class="hljs-type">BIGINT</span>,<br>  order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>  user_id <span class="hljs-type">BIGINT</span>,<br>  amount <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>  <span class="hljs-keyword">PRIMARY</span> KEY(id) <br>);<br></code></pre></td></tr></table></figure>
<h2 id="2„ÄÅÂü∫Êú¨Ê∞¥Âπ≥ÂàÜÁâá"><a href="#2„ÄÅÂü∫Êú¨Ê∞¥Âπ≥ÂàÜÁâá" class="headerlink" title="2„ÄÅÂü∫Êú¨Ê∞¥Âπ≥ÂàÜÁâá"></a>2„ÄÅÂü∫Êú¨Ê∞¥Âπ≥ÂàÜÁâá</h2><h3 id="2-1„ÄÅÂü∫Êú¨ÈÖçÁΩÆ"><a href="#2-1„ÄÅÂü∫Êú¨ÈÖçÁΩÆ" class="headerlink" title="2.1„ÄÅÂü∫Êú¨ÈÖçÁΩÆ"></a>2.1„ÄÅÂü∫Êú¨ÈÖçÁΩÆ</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#========================Âü∫Êú¨ÈÖçÁΩÆ</span><br><span class="hljs-comment"># Â∫îÁî®ÂêçÁß∞</span><br><span class="hljs-attr">spring.application.name</span>=<span class="hljs-string">sharging-jdbc-demo</span><br><span class="hljs-comment"># ÂºÄÂèëÁéØÂ¢ÉËÆæÁΩÆ</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-comment"># ÂÜÖÂ≠òÊ®°Âºè</span><br><span class="hljs-attr">spring.shardingsphere.mode.type</span>=<span class="hljs-string">Memory</span><br><span class="hljs-comment"># ÊâìÂç∞SQl</span><br><span class="hljs-attr">spring.shardingsphere.props.sql-show</span>=<span class="hljs-string">true</span><br></code></pre></td></tr></table></figure>
<h3 id="2-2„ÄÅÊï∞ÊçÆÊ∫êÈÖçÁΩÆ"><a href="#2-2„ÄÅÊï∞ÊçÆÊ∫êÈÖçÁΩÆ" class="headerlink" title="2.2„ÄÅÊï∞ÊçÆÊ∫êÈÖçÁΩÆ"></a>2.2„ÄÅÊï∞ÊçÆÊ∫êÈÖçÁΩÆ</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#========================Êï∞ÊçÆÊ∫êÈÖçÁΩÆ</span><br><span class="hljs-comment"># ÈÖçÁΩÆÁúüÂÆûÊï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.names</span>=<span class="hljs-string">server-user,server-order0,server-order1</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 1 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3301/db_user</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-user.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 2 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3310/db_order</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.password</span>=<span class="hljs-string">123456</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÈÖçÁΩÆÁ¨¨ 3 ‰∏™Êï∞ÊçÆÊ∫ê</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.type</span>=<span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.jdbc-url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3311/db_order</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.shardingsphere.datasource.server-order.password</span>=<span class="hljs-string">123456</span><br></code></pre></td></tr></table></figure>
<h3 id="2-3„ÄÅÊ†áÊ§éÂàÜÁâáË°®ÈÖçÁΩÆ"><a href="#2-3„ÄÅÊ†áÊ§éÂàÜÁâáË°®ÈÖçÁΩÆ" class="headerlink" title="2.3„ÄÅÊ†áÊ§éÂàÜÁâáË°®ÈÖçÁΩÆ"></a>2.3„ÄÅÊ†áÊ§éÂàÜÁâáË°®ÈÖçÁΩÆ</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#========================Ê†áÂáÜÂàÜÁâáË°®ÈÖçÁΩÆÔºàÊï∞ÊçÆËäÇÁÇπÈÖçÁΩÆÔºâ</span><br><span class="hljs-comment"># spring.shardingsphere.rules.sharding.tables.&lt;table-name&gt;.actual-data-nodes=ÂÄº</span><br><span class="hljs-comment"># ÂÄºÁî±Êï∞ÊçÆÊ∫êÂêç + Ë°®ÂêçÁªÑÊàêÔºå‰ª•Â∞èÊï∞ÁÇπÂàÜÈöî„ÄÇÂ§ö‰∏™Ë°®‰ª•ÈÄóÂè∑ÂàÜÈöîÔºåÊîØÊåÅ inline Ë°®ËææÂºè„ÄÇ</span><br><span class="hljs-comment"># &lt;table-name&gt;ÔºöÈÄªËæëË°®Âêç</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes</span>=<span class="hljs-string">server-user.t_user</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes</span>=<span class="hljs-string">server-order0.t_order0,server-order0.t_order1,server-order1.t_order0,server-order1.t_order1</span><br></code></pre></td></tr></table></figure>

<p>‰øÆÊîπOrderÂÆû‰ΩìÁ±ªÁöÑ‰∏ªÈîÆÁ≠ñÁï•Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//@TableId(type = IdType.AUTO)//‰æùËµñÊï∞ÊçÆÂ∫ìÁöÑ‰∏ªÈîÆËá™Â¢ûÁ≠ñÁï•</span><br><span class="hljs-meta">@TableId(type = IdType.ASSIGN_ID)</span><span class="hljs-comment">//ÂàÜÂ∏ÉÂºèid</span><br></code></pre></td></tr></table></figure>

<p>ÊµãËØïÔºö‰øùÁïô‰∏äÈù¢ÈÖçÁΩÆ‰∏≠ÁöÑ‰∏Ä‰∏™ÂàÜÁâáË°®ËäÇÁÇπÂàÜÂà´ËøõË°åÊµãËØïÔºåÊ£ÄÊü•ÊØè‰∏™ÂàÜÁâáËäÇÁÇπÊòØÂê¶ÂèØÁî®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ê∞¥Âπ≥ÂàÜÁâáÔºöÊèíÂÖ•Êï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsertOrder</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>    order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU001&quot;</span>);<br>    order.setUserId(<span class="hljs-number">1L</span>);<br>    order.setAmount(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>));<br>    orderMapper.insert(order);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="2-4„ÄÅË°åË°®ËææÂºè"><a href="#2-4„ÄÅË°åË°®ËææÂºè" class="headerlink" title="2.4„ÄÅË°åË°®ËææÂºè"></a>2.4„ÄÅË°åË°®ËææÂºè</h3><p>‰ºòÂåñ‰∏ä‰∏ÄÊ≠•ÁöÑÂàÜÁâáË°®ÈÖçÁΩÆ<br><a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/inline-expression/">https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/inline-expression/</a></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#========================Ê†áÂáÜÂàÜÁâáË°®ÈÖçÁΩÆÔºàÊï∞ÊçÆËäÇÁÇπÈÖçÁΩÆÔºâ</span><br><span class="hljs-comment"># spring.shardingsphere.rules.sharding.tables.&lt;table-name&gt;.actual-data-nodes=ÂÄº</span><br><span class="hljs-comment"># ÂÄºÁî±Êï∞ÊçÆÊ∫êÂêç + Ë°®ÂêçÁªÑÊàêÔºå‰ª•Â∞èÊï∞ÁÇπÂàÜÈöî„ÄÇÂ§ö‰∏™Ë°®‰ª•ÈÄóÂè∑ÂàÜÈöîÔºåÊîØÊåÅ inline Ë°®ËææÂºè„ÄÇ</span><br><span class="hljs-comment"># &lt;table-name&gt;ÔºöÈÄªËæëË°®Âêç</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_user.actual-data-nodes</span>=<span class="hljs-string">server-user.t_user</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.actual-data-nodes</span>=<span class="hljs-string">server-order$-&gt;&#123;0..1&#125;.t_order$-&gt;&#123;0..1&#125;</span><br></code></pre></td></tr></table></figure>



<h3 id="2-5„ÄÅÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ"><a href="#2-5„ÄÅÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ" class="headerlink" title="2.5„ÄÅÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ"></a>2.5„ÄÅÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ</h3><p><strong>Ê∞¥Âπ≥ÂàÜÂ∫ìÔºö</strong><br>ÂàÜÁâáËßÑÂàôÔºöorderË°®‰∏≠<code>user_id</code>‰∏∫ÂÅ∂Êï∞Êó∂ÔºåÊï∞ÊçÆÊèíÂÖ•<code>server-order0ÊúçÂä°Âô®</code>Ôºå<code>user_id</code>‰∏∫Â•áÊï∞Êó∂ÔºåÊï∞ÊçÆÊèíÂÖ•<code>server-order1ÊúçÂä°Âô®</code>„ÄÇËøôÊ†∑ÂàÜÁâáÁöÑÂ•ΩÂ§ÑÊòØÔºåÂêå‰∏Ä‰∏™Áî®Êà∑ÁöÑËÆ¢ÂçïÊï∞ÊçÆÔºå‰∏ÄÂÆö‰ºöË¢´ÊèíÂÖ•Âà∞Âêå‰∏ÄÂè∞ÊúçÂä°Âô®‰∏äÔºåÊü•ËØ¢‰∏Ä‰∏™Áî®Êà∑ÁöÑËÆ¢ÂçïÊó∂ÊïàÁéáËæÉÈ´ò„ÄÇ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#------------------------ÂàÜÂ∫ìÁ≠ñÁï•</span><br><span class="hljs-comment"># ÂàÜÁâáÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.database-strategy.standard.sharding-column</span>=<span class="hljs-string">user_id</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.database-strategy.standard.sharding-algorithm-name</span>=<span class="hljs-string">alg_inline_userid</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#------------------------ÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ</span><br><span class="hljs-comment"># Ë°åË°®ËææÂºèÂàÜÁâáÁÆóÊ≥ï</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÁ±ªÂûã</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_inline_userid.type</span>=<span class="hljs-string">INLINE</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂ±ûÊÄßÈÖçÁΩÆ</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_inline_userid.props.algorithm-expression</span>=<span class="hljs-string">server-order$-&gt;&#123;user_id % 2&#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÂèñÊ®°ÂàÜÁâáÁÆóÊ≥ï</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÁ±ªÂûã</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_mod.type</span>=<span class="hljs-string">MOD</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂ±ûÊÄßÈÖçÁΩÆ</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_mod.props.sharding-count</span>=<span class="hljs-string">2</span><br></code></pre></td></tr></table></figure>

<p>‰∏∫‰∫ÜÊñπ‰æøÊµãËØïÔºåÂÖàËÆæÁΩÆÂè™Âú® <code>t_order0</code>Ë°®‰∏äËøõË°åÊµãËØï</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">xxx.actual-data-nodes</span>=<span class="hljs-string">server-order$-&gt;&#123;0..1&#125;.t_order0</span><br></code></pre></td></tr></table></figure>

<p>ÊµãËØïÔºöÂèØ‰ª•ÂàÜÂà´ÊµãËØïË°åË°®ËææÂºèÂàÜÁâáÁÆóÊ≥ïÂíåÂèñÊ®°ÂàÜÁâáÁÆóÊ≥ï</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ê∞¥Âπ≥ÂàÜÁâáÔºöÂàÜÂ∫ìÊèíÂÖ•Êï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsertOrderDatabaseStrategy</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++) &#123;<br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU001&quot;</span>);<br>        order.setUserId(i + <span class="hljs-number">1</span>);<br>        order.setAmount(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>));<br>        orderMapper.insert(order);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<p><strong>Ê∞¥Âπ≥ÂàÜË°®Ôºö</strong><br>ÂàÜÁâáËßÑÂàôÔºöorderË°®‰∏≠<code>order_noÁöÑÂìàÂ∏åÂÄº‰∏∫ÂÅ∂Êï∞Êó∂</code>ÔºåÊï∞ÊçÆÊèíÂÖ•ÂØπÂ∫îÊúçÂä°Âô®ÁöÑ<code>t_order0Ë°®</code>Ôºå<code>order_noÁöÑÂìàÂ∏åÂÄº‰∏∫Â•áÊï∞Êó∂</code>ÔºåÊï∞ÊçÆÊèíÂÖ•ÂØπÂ∫îÊúçÂä°Âô®ÁöÑ<code>t_order1Ë°®</code>„ÄÇÂõ†‰∏∫order_noÊòØÂ≠óÁ¨¶‰∏≤ÂΩ¢ÂºèÔºåÂõ†Ê≠§‰∏çËÉΩÁõ¥Êé•ÂèñÊ®°„ÄÇ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#------------------------ÂàÜË°®Á≠ñÁï•</span><br><span class="hljs-comment"># ÂàÜÁâáÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.table-strategy.standard.sharding-column</span>=<span class="hljs-string">order_no</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.table-strategy.standard.sharding-algorithm-name</span>=<span class="hljs-string">alg_hash_mod</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#------------------------ÂàÜÁâáÁÆóÊ≥ïÈÖçÁΩÆ</span><br><span class="hljs-comment"># ÂìàÂ∏åÂèñÊ®°ÂàÜÁâáÁÆóÊ≥ï</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÁ±ªÂûã</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_hash_mod.type</span>=<span class="hljs-string">HASH_MOD</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂ±ûÊÄßÈÖçÁΩÆ</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.sharding-algorithms.alg_hash_mod.props.sharding-count</span>=<span class="hljs-string">2</span><br><br></code></pre></td></tr></table></figure>

<p>ÊµãËØïÂâç‰∏çË¶ÅÂøòËÆ∞Â∞ÜÂ¶Ç‰∏ãËäÇÁÇπÊîπÂõûÂéüÊù•ÁöÑÁä∂ÊÄÅ</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">xxx.actual-data-nodes</span>=<span class="hljs-string">server-order$-&gt;&#123;0..1&#125;.t_order$-&gt;&#123;0..1&#125;</span><br></code></pre></td></tr></table></figure>

<p>ÊµãËØïÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ê∞¥Âπ≥ÂàÜÁâáÔºöÂàÜË°®ÊèíÂÖ•Êï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsertOrderTableStrategy</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">5</span>; i++) &#123;<br><br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>        order.setUserId(<span class="hljs-number">1L</span>);<br>        order.setAmount(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>));<br>        orderMapper.insert(order);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>; i &lt; <span class="hljs-number">9</span>; i++) &#123;<br><br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>        order.setUserId(<span class="hljs-number">2L</span>);<br>        order.setAmount(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">100</span>));<br>        orderMapper.insert(order);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÊµãËØïÂìàÂ∏åÂèñÊ®°</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testHash</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-comment">//Ê≥®ÊÑèhashÂèñÊ®°ÁöÑÁªìÊûúÊòØÊï¥‰∏™Â≠óÁ¨¶‰∏≤hashÂêéÂÜçÂèñÊ®°ÔºåÂíåÊï∞ÂÄºÂêéÁºÄÊòØÂ•áÊï∞ËøòÊòØÂÅ∂Êï∞Êó†ÂÖ≥</span><br>    System.out.println(<span class="hljs-string">&quot;ATGUIGU001&quot;</span>.hashCode() % <span class="hljs-number">2</span>);<br>    System.out.println(<span class="hljs-string">&quot;ATGUIGU0011&quot;</span>.hashCode() % <span class="hljs-number">2</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>Êü•ËØ¢ÊµãËØïÔºö</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ê∞¥Âπ≥ÂàÜÁâáÔºöÊü•ËØ¢ÊâÄÊúâËÆ∞ÂΩï</span><br><span class="hljs-comment">     * Êü•ËØ¢‰∫Ü‰∏§‰∏™Êï∞ÊçÆÊ∫êÔºåÊØè‰∏™Êï∞ÊçÆÊ∫ê‰∏≠‰ΩøÁî®UNION ALLËøûÊé•‰∏§‰∏™Ë°®</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testShardingSelectAll</span><span class="hljs-params">()</span>&#123;<br><br>    List&lt;Order&gt; orders = orderMapper.selectList(<span class="hljs-literal">null</span>);<br>    orders.forEach(System.out::println);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ê∞¥Âπ≥ÂàÜÁâáÔºöÊ†πÊçÆuser_idÊü•ËØ¢ËÆ∞ÂΩï</span><br><span class="hljs-comment">     * Êü•ËØ¢‰∫Ü‰∏Ä‰∏™Êï∞ÊçÆÊ∫êÔºåÊØè‰∏™Êï∞ÊçÆÊ∫ê‰∏≠‰ΩøÁî®UNION ALLËøûÊé•‰∏§‰∏™Ë°®</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testShardingSelectByUserId</span><span class="hljs-params">()</span>&#123;<br><br>    QueryWrapper&lt;Order&gt; orderQueryWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;&gt;();<br>    orderQueryWrapper.eq(<span class="hljs-string">&quot;user_id&quot;</span>, <span class="hljs-number">1L</span>);<br>    List&lt;Order&gt; orders = orderMapper.selectList(orderQueryWrapper);<br>    orders.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="2-6„ÄÅÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ï"><a href="#2-6„ÄÅÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ï" class="headerlink" title="2.6„ÄÅÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ï"></a>2.6„ÄÅÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ï</h3><p><strong>Èõ™Ëä±ÁÆóÊ≥ïÔºö</strong></p>
<p><a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/key-generator/">https://shardingsphere.apache.org/document/5.1.1/cn/features/sharding/concept/key-generator/</a></p>
<p>Ê∞¥Âπ≥ÂàÜÁâáÈúÄË¶ÅÂÖ≥Ê≥®ÂÖ®Â±ÄÂ∫èÂàóÔºåÂõ†‰∏∫‰∏çËÉΩÁÆÄÂçïÁöÑ‰ΩøÁî®Âü∫‰∫éÊï∞ÊçÆÂ∫ìÁöÑ‰∏ªÈîÆËá™Â¢û„ÄÇ</p>
<p>ËøôÈáåÊúâ‰∏§ÁßçÊñπÊ°àÔºö‰∏ÄÁßçÊòØÂü∫‰∫éMyBatisPlusÁöÑidÁ≠ñÁï•Ôºõ‰∏ÄÁßçÊòØShardingSphere-JDBCÁöÑÂÖ®Â±ÄÂ∫èÂàóÈÖçÁΩÆ„ÄÇ</p>
<p><code>Âü∫‰∫éMyBatisPlusÁöÑidÁ≠ñÁï•Ôºö</code>Â∞ÜOrderÁ±ªÁöÑidËÆæÁΩÆÊàêÂ¶Ç‰∏ãÂΩ¢Âºè</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@TableId(type = IdType.ASSIGN_ID)</span><br><span class="hljs-keyword">private</span> Long id;<br></code></pre></td></tr></table></figure>

<p><code>Âü∫‰∫éShardingSphere-JDBCÁöÑÂÖ®Â±ÄÂ∫èÂàóÈÖçÁΩÆ</code>ÔºöÂíåÂâçÈù¢ÁöÑMyBatisPlusÁöÑÁ≠ñÁï•‰∫åÈÄâ‰∏Ä</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#------------------------ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁ≠ñÁï•ÈÖçÁΩÆ</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.key-generate-strategy.column</span>=<span class="hljs-string">id</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order.key-generate-strategy.key-generator-name</span>=<span class="hljs-string">alg_snowflake</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ïÈÖçÁΩÆ</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ïÁ±ªÂûã</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.key-generators.alg_snowflake.type</span>=<span class="hljs-string">SNOWFLAKE</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ïÂ±ûÊÄßÈÖçÁΩÆ</span><br><span class="hljs-comment">#spring.shardingsphere.rules.sharding.key-generators.alg_snowflake.props.xxx=</span><br></code></pre></td></tr></table></figure>

<p>Ê≠§Êó∂ÔºåÈúÄË¶ÅÂ∞ÜÂÆû‰ΩìÁ±ª‰∏≠ÁöÑidÁ≠ñÁï•‰øÆÊîπÊàê‰ª•‰∏ãÂΩ¢ÂºèÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ÂΩìÈÖçÁΩÆ‰∫Üshardingsphere-jdbcÁöÑÂàÜÂ∏ÉÂºèÂ∫èÂàóÊó∂ÔºåËá™Âä®‰ΩøÁî®shardingsphere-jdbcÁöÑÂàÜÂ∏ÉÂºèÂ∫èÂàó</span><br><span class="hljs-comment">//ÂΩìÊ≤°ÊúâÈÖçÁΩÆshardingsphere-jdbcÁöÑÂàÜÂ∏ÉÂºèÂ∫èÂàóÊó∂ÔºåËá™Âä®‰æùËµñÊï∞ÊçÆÂ∫ìÁöÑ‰∏ªÈîÆËá™Â¢ûÁ≠ñÁï•</span><br><span class="hljs-meta">@TableId(type = IdType.AUTO)</span><br></code></pre></td></tr></table></figure>

<h2 id="3„ÄÅÂ§öË°®ÂÖ≥ËÅî"><a href="#3„ÄÅÂ§öË°®ÂÖ≥ËÅî" class="headerlink" title="3„ÄÅÂ§öË°®ÂÖ≥ËÅî"></a>3„ÄÅÂ§öË°®ÂÖ≥ËÅî</h2><h3 id="3-1„ÄÅÂàõÂª∫ÂÖ≥ËÅîË°®"><a href="#3-1„ÄÅÂàõÂª∫ÂÖ≥ËÅîË°®" class="headerlink" title="3.1„ÄÅÂàõÂª∫ÂÖ≥ËÅîË°®"></a>3.1„ÄÅÂàõÂª∫ÂÖ≥ËÅîË°®</h3><p>Âú®<code>server-order0„ÄÅserver-order1</code>ÊúçÂä°Âô®‰∏≠ÂàÜÂà´ÂàõÂª∫‰∏§Âº†ËÆ¢ÂçïËØ¶ÊÉÖË°®<code>t_order_item0„ÄÅt_order_item1</code></p>
<p>Êàë‰ª¨Â∏åÊúõ<code>Âêå‰∏Ä‰∏™Áî®Êà∑ÁöÑËÆ¢ÂçïË°®ÂíåËÆ¢ÂçïËØ¶ÊÉÖË°®‰∏≠ÁöÑÊï∞ÊçÆÈÉΩÂú®Âêå‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê‰∏≠ÔºåÈÅøÂÖçË∑®Â∫ìÂÖ≥ËÅî</code>ÔºåÂõ†Ê≠§Ëøô‰∏§Âº†Ë°®Êàë‰ª¨‰ΩøÁî®Áõ∏ÂêåÁöÑÂàÜÁâáÁ≠ñÁï•„ÄÇ</p>
<p>ÈÇ£‰πàÂú®<code>t_order_item</code>‰∏≠Êàë‰ª¨‰πüÈúÄË¶ÅÂàõÂª∫<code>order_no</code>Âíå<code>user_id</code>Ëøô‰∏§‰∏™ÂàÜÁâáÈîÆ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order_item0(<br>    id <span class="hljs-type">BIGINT</span>,<br>    order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>    user_id <span class="hljs-type">BIGINT</span>,<br>    price <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>    `count` <span class="hljs-type">INT</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY(id)<br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_order_item1(<br>    id <span class="hljs-type">BIGINT</span>,<br>    order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>),<br>    user_id <span class="hljs-type">BIGINT</span>,<br>    price <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>),<br>    `count` <span class="hljs-type">INT</span>,<br>    <span class="hljs-keyword">PRIMARY</span> KEY(id)<br>);<br></code></pre></td></tr></table></figure>

<h3 id="3-2„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"><a href="#3-2„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª" class="headerlink" title="3.2„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"></a>3.2„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.entity;<br><br><span class="hljs-meta">@TableName(&quot;t_order_item&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderItem</span> &#123;<br>    <span class="hljs-comment">//ÂΩìÈÖçÁΩÆ‰∫Üshardingsphere-jdbcÁöÑÂàÜÂ∏ÉÂºèÂ∫èÂàóÊó∂ÔºåËá™Âä®‰ΩøÁî®shardingsphere-jdbcÁöÑÂàÜÂ∏ÉÂºèÂ∫èÂàó</span><br>    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String orderNo;<br>    <span class="hljs-keyword">private</span> Long userId;<br>    <span class="hljs-keyword">private</span> BigDecimal price;<br>    <span class="hljs-keyword">private</span> Integer count;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="3-3„ÄÅÂàõÂª∫Mapper"><a href="#3-3„ÄÅÂàõÂª∫Mapper" class="headerlink" title="3.3„ÄÅÂàõÂª∫Mapper"></a>3.3„ÄÅÂàõÂª∫Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shargingjdbcdemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderItemMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;OrderItem&gt; &#123;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-4„ÄÅÈÖçÁΩÆÂÖ≥ËÅîË°®"><a href="#3-4„ÄÅÈÖçÁΩÆÂÖ≥ËÅîË°®" class="headerlink" title="3.4„ÄÅÈÖçÁΩÆÂÖ≥ËÅîË°®"></a>3.4„ÄÅÈÖçÁΩÆÂÖ≥ËÅîË°®</h3><p>t_order_itemÁöÑÂàÜÁâáË°®„ÄÅÂàÜÁâáÁ≠ñÁï•„ÄÅÂàÜÂ∏ÉÂºèÂ∫èÂàóÁ≠ñÁï•Âíåt_order‰∏ÄËá¥</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#------------------------Ê†áÂáÜÂàÜÁâáË°®ÈÖçÁΩÆÔºàÊï∞ÊçÆËäÇÁÇπÈÖçÁΩÆÔºâ</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.actual-data-nodes</span>=<span class="hljs-string">server-order$-&gt;&#123;0..1&#125;.t_order_item$-&gt;&#123;0..1&#125;</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#------------------------ÂàÜÂ∫ìÁ≠ñÁï•</span><br><span class="hljs-comment"># ÂàÜÁâáÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.database-strategy.standard.sharding-column</span>=<span class="hljs-string">user_id</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.database-strategy.standard.sharding-algorithm-name</span>=<span class="hljs-string">alg_mod</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#------------------------ÂàÜË°®Á≠ñÁï•</span><br><span class="hljs-comment"># ÂàÜÁâáÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.table-strategy.standard.sharding-column</span>=<span class="hljs-string">order_no</span><br><span class="hljs-comment"># ÂàÜÁâáÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.table-strategy.standard.sharding-algorithm-name</span>=<span class="hljs-string">alg_hash_mod</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#------------------------ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁ≠ñÁï•ÈÖçÁΩÆ</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÂàóÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.key-generate-strategy.column</span>=<span class="hljs-string">id</span><br><span class="hljs-comment"># ÂàÜÂ∏ÉÂºèÂ∫èÂàóÁÆóÊ≥ïÂêçÁß∞</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_order_item.key-generate-strategy.key-generator-name</span>=<span class="hljs-string">alg_snowflake</span><br></code></pre></td></tr></table></figure>



<h3 id="3-5„ÄÅÊµãËØïÊèíÂÖ•Êï∞ÊçÆ"><a href="#3-5„ÄÅÊµãËØïÊèíÂÖ•Êï∞ÊçÆ" class="headerlink" title="3.5„ÄÅÊµãËØïÊèíÂÖ•Êï∞ÊçÆ"></a>3.5„ÄÅÊµãËØïÊèíÂÖ•Êï∞ÊçÆ</h3><p>Âêå‰∏Ä‰∏™Áî®Êà∑ÁöÑËÆ¢ÂçïË°®ÂíåËÆ¢ÂçïËØ¶ÊÉÖË°®‰∏≠ÁöÑÊï∞ÊçÆÈÉΩÂú®Âêå‰∏Ä‰∏™Êï∞ÊçÆÊ∫ê‰∏≠ÔºåÈÅøÂÖçË∑®Â∫ìÂÖ≥ËÅî</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÊµãËØïÂÖ≥ËÅîË°®ÊèíÂÖ•</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInsertOrderAndOrderItem</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; <span class="hljs-number">3</span>; i++) &#123;<br><br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>        order.setUserId(<span class="hljs-number">1L</span>);<br>        orderMapper.insert(order);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; <span class="hljs-number">3</span>; j++) &#123;<br>            <span class="hljs-type">OrderItem</span> <span class="hljs-variable">orderItem</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>();<br>            orderItem.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>            orderItem.setUserId(<span class="hljs-number">1L</span>);<br>            orderItem.setPrice(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">10</span>));<br>            orderItem.setCount(<span class="hljs-number">2</span>);<br>            orderItemMapper.insert(orderItem);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">5</span>; i &lt; <span class="hljs-number">7</span>; i++) &#123;<br><br>        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>        order.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>        order.setUserId(<span class="hljs-number">2L</span>);<br>        orderMapper.insert(order);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt; <span class="hljs-number">3</span>; j++) &#123;<br>            <span class="hljs-type">OrderItem</span> <span class="hljs-variable">orderItem</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderItem</span>();<br>            orderItem.setOrderNo(<span class="hljs-string">&quot;ATGUIGU&quot;</span> + i);<br>            orderItem.setUserId(<span class="hljs-number">2L</span>);<br>            orderItem.setPrice(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BigDecimal</span>(<span class="hljs-number">1</span>));<br>            orderItem.setCount(<span class="hljs-number">3</span>);<br>            orderItemMapper.insert(orderItem);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>



<h2 id="4„ÄÅÁªëÂÆöË°®"><a href="#4„ÄÅÁªëÂÆöË°®" class="headerlink" title="4„ÄÅÁªëÂÆöË°®"></a>4„ÄÅÁªëÂÆöË°®</h2><p><strong>ÈúÄÊ±ÇÔºö</strong>Êü•ËØ¢ÊØè‰∏™ËÆ¢ÂçïÁöÑËÆ¢ÂçïÂè∑ÂíåÊÄªËÆ¢ÂçïÈáëÈ¢ù</p>
<h3 id="4-1„ÄÅÂàõÂª∫VOÂØπË±°"><a href="#4-1„ÄÅÂàõÂª∫VOÂØπË±°" class="headerlink" title="4.1„ÄÅÂàõÂª∫VOÂØπË±°"></a>4.1„ÄÅÂàõÂª∫VOÂØπË±°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.entity;<br><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderVo</span> &#123;<br>    <span class="hljs-keyword">private</span> String orderNo;<br>    <span class="hljs-keyword">private</span> BigDecimal amount;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="4-2„ÄÅÊ∑ªÂä†MapperÊñπÊ≥ï"><a href="#4-2„ÄÅÊ∑ªÂä†MapperÊñπÊ≥ï" class="headerlink" title="4.2„ÄÅÊ∑ªÂä†MapperÊñπÊ≥ï"></a>4.2„ÄÅÊ∑ªÂä†MapperÊñπÊ≥ï</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">OrderMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Order&gt; &#123;<br><br>    <span class="hljs-meta">@Select(&#123;&quot;SELECT o.order_no, SUM(i.price * i.count) AS amount&quot;,</span><br><span class="hljs-meta">            &quot;FROM t_order o JOIN t_order_item i ON o.order_no = i.order_no&quot;,</span><br><span class="hljs-meta">            &quot;GROUP BY o.order_no&quot;&#125;)</span><br>    List&lt;OrderVo&gt; <span class="hljs-title function_">getOrderAmount</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="4-3„ÄÅÊµãËØïÂÖ≥ËÅîÊü•ËØ¢"><a href="#4-3„ÄÅÊµãËØïÂÖ≥ËÅîÊü•ËØ¢" class="headerlink" title="4.3„ÄÅÊµãËØïÂÖ≥ËÅîÊü•ËØ¢"></a>4.3„ÄÅÊµãËØïÂÖ≥ËÅîÊü•ËØ¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÊµãËØïÂÖ≥ËÅîË°®Êü•ËØ¢</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetOrderAmount</span><span class="hljs-params">()</span>&#123;<br><br>    List&lt;OrderVo&gt; orderAmountList = orderMapper.getOrderAmount();<br>    orderAmountList.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-4„ÄÅÈÖçÁΩÆÁªëÂÆöË°®"><a href="#4-4„ÄÅÈÖçÁΩÆÁªëÂÆöË°®" class="headerlink" title="4.4„ÄÅÈÖçÁΩÆÁªëÂÆöË°®"></a>4.4„ÄÅÈÖçÁΩÆÁªëÂÆöË°®</h3><p>Âú®ÂéüÊù•Ê∞¥Âπ≥ÂàÜÁâáÈÖçÁΩÆÁöÑÂü∫Á°Ä‰∏äÊ∑ªÂä†Â¶Ç‰∏ãÈÖçÁΩÆÔºö</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#------------------------ÁªëÂÆöË°®</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.binding-tables[0]</span>=<span class="hljs-string">t_order,t_order_item</span><br></code></pre></td></tr></table></figure>
<p>ÈÖçÁΩÆÂÆåÁªëÂÆöË°®ÂêéÂÜçÊ¨°ËøõË°åÂÖ≥ËÅîÊü•ËØ¢ÁöÑÊµãËØïÔºö</p>
<ul>
<li><p><strong>Â¶ÇÊûú‰∏çÈÖçÁΩÆÁªëÂÆöË°®ÔºöÊµãËØïÁöÑÁªìÊûú‰∏∫8‰∏™SQL„ÄÇ</strong>Â§öË°®ÂÖ≥ËÅîÊü•ËØ¢‰ºöÂá∫Áé∞Á¨õÂç°Â∞îÁßØÂÖ≥ËÅî„ÄÇ</p>
</li>
<li><p><strong>Â¶ÇÊûúÈÖçÁΩÆÁªëÂÆöË°®ÔºöÊµãËØïÁöÑÁªìÊûú‰∏∫4‰∏™SQL„ÄÇ</strong> Â§öË°®ÂÖ≥ËÅîÊü•ËØ¢‰∏ç‰ºöÂá∫Áé∞Á¨õÂç°Â∞îÁßØÂÖ≥ËÅîÔºåÂÖ≥ËÅîÊü•ËØ¢ÊïàÁéáÂ∞ÜÂ§ßÂ§ßÊèêÂçá„ÄÇ</p>
</li>
</ul>
<p><code>ÁªëÂÆöË°®Ôºö</code>ÊåáÂàÜÁâáËßÑÂàô‰∏ÄËá¥ÁöÑ‰∏ÄÁªÑÂàÜÁâáË°®„ÄÇ ‰ΩøÁî®ÁªëÂÆöË°®ËøõË°åÂ§öË°®ÂÖ≥ËÅîÊü•ËØ¢Êó∂ÔºåÂøÖÈ°ª‰ΩøÁî®ÂàÜÁâáÈîÆËøõË°åÂÖ≥ËÅîÔºåÂê¶Âàô‰ºöÂá∫Áé∞Á¨õÂç°Â∞îÁßØÂÖ≥ËÅîÊàñË∑®Â∫ìÂÖ≥ËÅîÔºå‰ªéËÄåÂΩ±ÂìçÊü•ËØ¢ÊïàÁéá„ÄÇ</p>
<h2 id="5„ÄÅÂπøÊí≠Ë°®"><a href="#5„ÄÅÂπøÊí≠Ë°®" class="headerlink" title="5„ÄÅÂπøÊí≠Ë°®"></a>5„ÄÅÂπøÊí≠Ë°®</h2><h3 id="4-1„ÄÅ‰ªÄ‰πàÊòØÂπøÊí≠Ë°®"><a href="#4-1„ÄÅ‰ªÄ‰πàÊòØÂπøÊí≠Ë°®" class="headerlink" title="4.1„ÄÅ‰ªÄ‰πàÊòØÂπøÊí≠Ë°®"></a>4.1„ÄÅ‰ªÄ‰πàÊòØÂπøÊí≠Ë°®</h3><p>ÊåáÊâÄÊúâÁöÑÂàÜÁâáÊï∞ÊçÆÊ∫ê‰∏≠ÈÉΩÂ≠òÂú®ÁöÑË°®ÔºåË°®ÁªìÊûÑÂèäÂÖ∂Êï∞ÊçÆÂú®ÊØè‰∏™Êï∞ÊçÆÂ∫ì‰∏≠ÂùáÂÆåÂÖ®‰∏ÄËá¥„ÄÇ ÈÄÇÁî®‰∫éÊï∞ÊçÆÈáè‰∏çÂ§ß‰∏îÈúÄË¶Å‰∏éÊµ∑ÈáèÊï∞ÊçÆÁöÑË°®ËøõË°åÂÖ≥ËÅîÊü•ËØ¢ÁöÑÂú∫ÊôØÔºå‰æãÂ¶ÇÔºöÂ≠óÂÖ∏Ë°®„ÄÇ<br>ÂπøÊí≠ÂÖ∑Êúâ‰ª•‰∏ãÁâπÊÄßÔºö<br>Ôºà1ÔºâÊèíÂÖ•„ÄÅÊõ¥Êñ∞Êìç‰Ωú‰ºöÂÆûÊó∂Âú®ÊâÄÊúâËäÇÁÇπ‰∏äÊâßË°åÔºå‰øùÊåÅÂêÑ‰∏™ÂàÜÁâáÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄß</p>
<p>Ôºà2ÔºâÊü•ËØ¢Êìç‰ΩúÔºåÂè™‰ªé‰∏Ä‰∏™ËäÇÁÇπËé∑Âèñ</p>
<p>Ôºà3ÔºâÂèØ‰ª•Ë∑ü‰ªª‰Ωï‰∏Ä‰∏™Ë°®ËøõË°å JOIN Êìç‰Ωú</p>
<h3 id="4-2„ÄÅÂàõÂª∫ÂπøÊí≠Ë°®"><a href="#4-2„ÄÅÂàõÂª∫ÂπøÊí≠Ë°®" class="headerlink" title="4.2„ÄÅÂàõÂª∫ÂπøÊí≠Ë°®"></a>4.2„ÄÅÂàõÂª∫ÂπøÊí≠Ë°®</h3><p>Âú®server-order0„ÄÅserver-order1Âíåserver-userÊúçÂä°Âô®‰∏≠ÂàÜÂà´ÂàõÂª∫t_dictË°®</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t_dict(<br>    id <span class="hljs-type">BIGINT</span>,<br>    dict_type <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY(id)<br>);<br></code></pre></td></tr></table></figure>
<h3 id="4-3„ÄÅÁ®ãÂ∫èÂÆûÁé∞"><a href="#4-3„ÄÅÁ®ãÂ∫èÂÆûÁé∞" class="headerlink" title="4.3„ÄÅÁ®ãÂ∫èÂÆûÁé∞"></a>4.3„ÄÅÁ®ãÂ∫èÂÆûÁé∞</h3><h4 id="4-3-1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"><a href="#4-3-1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª" class="headerlink" title="4.3.1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"></a>4.3.1„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.entity;<br><br><span class="hljs-meta">@TableName(&quot;t_dict&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dict</span> &#123;<br>    <span class="hljs-comment">//ÂèØ‰ª•‰ΩøÁî®MyBatisPlusÁöÑÈõ™Ëä±ÁÆóÊ≥ï</span><br>    <span class="hljs-meta">@TableId(type = IdType.ASSIGN_ID)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String dictType;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="4-3-2„ÄÅÂàõÂª∫Mapper"><a href="#4-3-2„ÄÅÂàõÂª∫Mapper" class="headerlink" title="4.3.2„ÄÅÂàõÂª∫Mapper"></a>4.3.2„ÄÅÂàõÂª∫Mapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingjdbcdemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">DictMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;Dict&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-3-3„ÄÅÈÖçÁΩÆÂπøÊí≠Ë°®"><a href="#4-3-3„ÄÅÈÖçÁΩÆÂπøÊí≠Ë°®" class="headerlink" title="4.3.3„ÄÅÈÖçÁΩÆÂπøÊí≠Ë°®"></a>4.3.3„ÄÅÈÖçÁΩÆÂπøÊí≠Ë°®</h4><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#Êï∞ÊçÆËäÇÁÇπÂèØ‰∏çÈÖçÁΩÆÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÂêëÊâÄÊúâÊï∞ÊçÆÊ∫êÂπøÊí≠</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.tables.t_dict.actual-data-nodes</span>=<span class="hljs-string">server-user.t_dict,server-order$-&gt;&#123;0..1&#125;.t_dict</span><br><span class="hljs-comment"></span><br><span class="hljs-comment"># ÂπøÊí≠Ë°®</span><br><span class="hljs-attr">spring.shardingsphere.rules.sharding.broadcast-tables[0]</span>=<span class="hljs-string">t_dict</span><br></code></pre></td></tr></table></figure>

<h3 id="4-4„ÄÅÊµãËØïÂπøÊí≠Ë°®"><a href="#4-4„ÄÅÊµãËØïÂπøÊí≠Ë°®" class="headerlink" title="4.4„ÄÅÊµãËØïÂπøÊí≠Ë°®"></a>4.4„ÄÅÊµãËØïÂπøÊí≠Ë°®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Autowired</span><br><span class="hljs-keyword">private</span> DictMapper dictMapper;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ÂπøÊí≠Ë°®ÔºöÊØè‰∏™ÊúçÂä°Âô®‰∏≠ÁöÑt_dictÂêåÊó∂Ê∑ªÂä†‰∫ÜÊñ∞Êï∞ÊçÆ</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testBroadcast</span><span class="hljs-params">()</span>&#123;<br><br>    <span class="hljs-type">Dict</span> <span class="hljs-variable">dict</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dict</span>();<br>    dict.setDictType(<span class="hljs-string">&quot;type1&quot;</span>);<br>    dictMapper.insert(dict);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Êü•ËØ¢Êìç‰ΩúÔºåÂè™‰ªé‰∏Ä‰∏™ËäÇÁÇπËé∑ÂèñÊï∞ÊçÆ</span><br><span class="hljs-comment">     * ÈöèÊú∫Ë¥üËΩΩÂùáË°°ËßÑÂàô</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSelectBroadcast</span><span class="hljs-params">()</span>&#123;<br><br>    List&lt;Dict&gt; dicts = dictMapper.selectList(<span class="hljs-literal">null</span>);<br>    dicts.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="Á¨¨07Á´†-ÂêØÂä®ShardingSphere-Proxy"><a href="#Á¨¨07Á´†-ÂêØÂä®ShardingSphere-Proxy" class="headerlink" title="Á¨¨07Á´† ÂêØÂä®ShardingSphere-Proxy"></a>Á¨¨07Á´† ÂêØÂä®ShardingSphere-Proxy</h1><h2 id="1„ÄÅËé∑Âèñ"><a href="#1„ÄÅËé∑Âèñ" class="headerlink" title="1„ÄÅËé∑Âèñ"></a>1„ÄÅËé∑Âèñ</h2><p>ÁõÆÂâç ShardingSphere-Proxy Êèê‰æõ‰∫Ü 3 ÁßçËé∑ÂèñÊñπÂºèÔºö</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/bin/">‰∫åËøõÂà∂ÂèëÂ∏ÉÂåÖ</a></li>
<li><a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/docker/">Docker</a></li>
<li><a target="_blank" rel="noopener" href="https://shardingsphere.apache.org/document/5.1.1/cn/user-manual/shardingsphere-proxy/startup/helm/">Helm</a></li>
</ul>
<h2 id="2„ÄÅ‰ΩøÁî®‰∫åËøõÂà∂ÂèëÂ∏ÉÂåÖÂÆâË£Ö"><a href="#2„ÄÅ‰ΩøÁî®‰∫åËøõÂà∂ÂèëÂ∏ÉÂåÖÂÆâË£Ö" class="headerlink" title="2„ÄÅ‰ΩøÁî®‰∫åËøõÂà∂ÂèëÂ∏ÉÂåÖÂÆâË£Ö"></a>2„ÄÅ‰ΩøÁî®‰∫åËøõÂà∂ÂèëÂ∏ÉÂåÖÂÆâË£Ö</h2><p>‰∫åËøõÂà∂ÂåÖÊó¢ÂèØ‰ª•LinuxÁ≥ªÁªüËøêË°åÔºåÂèàÂèØ‰ª•Âú®windowsÁ≥ªÁªüËøêË°å</p>
<p><strong>step1ÔºöËß£Âéã‰∫åËøõÂà∂ÂåÖ</strong></p>
<p><code>apache-shardingsphere-5.1.1-shardingsphere-proxy-bin.tar.gz</code></p>
<p>windowsÔºö‰ΩøÁî®Ëß£ÂéãËΩØ‰ª∂Ëß£ÂéãÊñá‰ª∂</p>
<p>LinuxÔºöÂ∞ÜÊñá‰ª∂‰∏ä‰º†Ëá≥&#x2F;optÁõÆÂΩïÔºåÂπ∂Ëß£Âéã</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">tar -zxvf apache-shardingsphere-5.1.1-shardingsphere-proxy-bin.tar.gz<br></code></pre></td></tr></table></figure>

<p><strong>step2ÔºöMySQLÈ©±Âä®</strong></p>
<p><code>mysql-connector-java-8.0.22.jar</code></p>
<p>Â∞ÜMySQlÈ©±Âä®ÊîæËá≥Ëß£ÂéãÁõÆÂΩï‰∏≠ÁöÑ<code>ext-lib</code>ÁõÆÂΩï</p>
<p><strong>step3Ôºö‰øÆÊîπÈÖçÁΩÆconf&#x2F;server.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">rules:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-type">!AUTHORITY</span><br>    <span class="hljs-attr">users:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">root@%:root</span><br>    <span class="hljs-attr">provider:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">ALL_PRIVILEGES_PERMITTED</span><br><br><span class="hljs-attr">props:</span><br>  <span class="hljs-attr">sql-show:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p><strong>step4ÔºöÂêØÂä®ShardingSphere-Proxy</strong></p>
<p>Linux Êìç‰ΩúÁ≥ªÁªüËØ∑ËøêË°å <code>bin/start.sh</code></p>
<p>Windows Êìç‰ΩúÁ≥ªÁªüËØ∑ËøêË°å <code>bin/start.bat</code> </p>
<p>ÊåáÂÆöÁ´ØÂè£Âè∑ÂíåÈÖçÁΩÆÊñá‰ª∂ÁõÆÂΩïÔºö<code>bin/start.bat $&#123;proxy_port&#125; $&#123;proxy_conf_directory&#125;</code> </p>
<p><strong>step5ÔºöËøúÁ®ãËøûÊé•ShardingSphere-Proxy</strong></p>
<p>ËøúÁ®ãËÆøÈóÆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -h192.168.100.1 -P3307 -uroot -p<br></code></pre></td></tr></table></figure>

<p><strong>step6ÔºöËÆøÈóÆÊµãËØï</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> databases;<br></code></pre></td></tr></table></figure>

<p><img src="image-20220819152009158.png" srcset="/img/loading.gif" lazyload alt="image-20220819152009158"></p>
<h2 id="3„ÄÅ‰ΩøÁî®DockerÂÆâË£Ö"><a href="#3„ÄÅ‰ΩøÁî®DockerÂÆâË£Ö" class="headerlink" title="3„ÄÅ‰ΩøÁî®DockerÂÆâË£Ö"></a>3„ÄÅ‰ΩøÁî®DockerÂÆâË£Ö</h2><p><strong>step1ÔºöÂêØÂä®DockerÂÆπÂô®</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d \<br>-v /atguigu/server/proxy-a/conf:/opt/shardingsphere-proxy/conf \<br>-v /atguigu/server/proxy-a/ext-lib:/opt/shardingsphere-proxy/ext-lib \<br>-e ES_JAVA_OPTS=&quot;-Xmx256m -Xms256m -Xmn128m&quot; \<br>-p 3321:3307 \<br>--name server-proxy-a \<br>apache/shardingsphere-proxy:5.1.1<br></code></pre></td></tr></table></figure>

<p><strong>step2Ôºö‰∏ä‰º†MySQLÈ©±Âä®</strong></p>
<p>Â∞ÜMySQlÈ©±Âä®‰∏ä‰º†Ëá≥<code>/atguigu/server/proxy-a/ext-lib</code>ÁõÆÂΩï</p>
<p><strong>step3Ôºö‰øÆÊîπÈÖçÁΩÆserver.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">rules:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-type">!AUTHORITY</span><br>    <span class="hljs-attr">users:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">root@%:root</span><br>    <span class="hljs-attr">provider:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">ALL_PRIVILEGES_PERMITTED</span><br><br><span class="hljs-attr">props:</span><br>  <span class="hljs-attr">sql-show:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>

<p>Â∞ÜÈÖçÁΩÆÊñá‰ª∂‰∏ä‰º†Ëá≥<code>/atguigu/server/proxy-a/conf</code>ÁõÆÂΩï</p>
<p><strong>step4ÔºöÈáçÂêØÂÆπÂô®</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart server-proxy-a<br></code></pre></td></tr></table></figure>

<p><strong>step5ÔºöËøúÁ®ãËøûÊé•ShardingSphere-Proxy</strong></p>
<p>ShardingSphere-ProxyÂÆπÂô®‰∏≠ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊ≤°ÊúâmysqlÂëΩ‰ª§Ë°åÂÆ¢Êà∑Á´ØÁöÑÂÆâË£ÖÔºåÂõ†Ê≠§ÈúÄË¶ÅËøúÁ®ãËÆøÈóÆ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -h192.168.100.201 -P3321 -uroot -p<br></code></pre></td></tr></table></figure>

<p><strong>step6ÔºöËÆøÈóÆÊµãËØï</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> databases;<br></code></pre></td></tr></table></figure>

<p><img src="image-20220819152009158.png" srcset="/img/loading.gif" lazyload alt="image-20220819152009158"></p>
<p><strong>Â∏∏ËßÅÈóÆÈ¢òÔºödockerÂÆπÂô®Êó†Ê≥ïËøúÁ®ãËøûÊé•</strong></p>
<p>ÂÆπÂô®ÂèØ‰ª•ÊàêÂäüÁöÑÂàõÂª∫Âπ∂ÂêØÂä®Ôºå‰ΩÜÊòØÊó†Ê≥ïËøúÁ®ãËøûÊé•„ÄÇÊéíÈô§Èò≤ÁÅ´Â¢ôÂíåÁΩëÁªúÁ≠âÈóÆÈ¢òÂêéÔºåÁúãÁúãÊòØ‰∏çÊòØÂõ†‰∏∫ÂÆπÂô®ÂÜÖÂ≠ò‰∏çË∂≥ÂØºËá¥„ÄÇ</p>
<p><code>ÂéüÂõ†Ôºö</code>ÂÆπÂô®ÂèØÂàÜÈÖçÂÜÖÂ≠ò‰∏çË∂≥</p>
<p><code>Êü•ÁúãÂäûÊ≥ïÔºö</code>ËøõÂÖ•ÂÆπÂô®ÂêéÊü•ÁúãShardingSphere-ProxyÁöÑÊó•ÂøóÔºåÂ¶ÇÊúâÊúâ<code>cannot allocate memory</code>ÔºåÂàôËØ¥ÊòéÂÆπÂô®ÂÜÖÂ≠ò‰∏çË∂≥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it server-proxy-a env LANG=C.UTF-8 /bin/bash<br>cd /opt/shardingsphere-proxy/logs<br>tail stdout.log <br></code></pre></td></tr></table></figure>

<p><img src="image-20220819151154763.png" srcset="/img/loading.gif" lazyload alt="image-20220819151154763"></p>
<p><code>Ëß£ÂÜ≥ÊñπÊ°àÔºö</code>ÂàõÂª∫ÂÆπÂô®ÁöÑÊó∂ÂÄô‰ΩøÁî®JVMÂèÇÊï∞</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">-e ES_JAVA_OPTS=&quot;-Xmx256m -Xms256m -Xmn128m&quot;<br></code></pre></td></tr></table></figure>

<h1 id="Á¨¨08Á´†-ShardingSphere-ProxyËØªÂÜôÂàÜÁ¶ª"><a href="#Á¨¨08Á´†-ShardingSphere-ProxyËØªÂÜôÂàÜÁ¶ª" class="headerlink" title="Á¨¨08Á´† ShardingSphere-ProxyËØªÂÜôÂàÜÁ¶ª"></a>Á¨¨08Á´† ShardingSphere-ProxyËØªÂÜôÂàÜÁ¶ª</h1><h2 id="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂"><a href="#1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂"></a>1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</h2><p><strong>‰øÆÊîπÈÖçÁΩÆconfig-readwrite-splitting.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">schemaName:</span> <span class="hljs-string">readwrite_splitting_db</span><br><br><span class="hljs-attr">dataSources:</span><br>  <span class="hljs-attr">write_ds:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3306/db_user?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">read_ds_0:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3307/db_user?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">read_ds_1:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3308/db_user?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br><br><span class="hljs-attr">rules:</span><br><span class="hljs-bullet">-</span> <span class="hljs-type">!READWRITE_SPLITTING</span><br>  <span class="hljs-attr">dataSources:</span><br>    <span class="hljs-attr">readwrite_ds:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">Static</span><br>      <span class="hljs-attr">props:</span><br>        <span class="hljs-attr">write-data-source-name:</span> <span class="hljs-string">write_ds</span><br>        <span class="hljs-attr">read-data-source-names:</span> <span class="hljs-string">read_ds_0,read_ds_1</span><br></code></pre></td></tr></table></figure>

<p>Â∞ÜÈÖçÁΩÆÊñá‰ª∂‰∏ä‰º†Ëá≥<code>/atguigu/server/proxy-a/conf</code>ÁõÆÂΩï</p>
<p><strong>ÈáçÂêØÂÆπÂô®</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart server-proxy-a<br></code></pre></td></tr></table></figure>

<h2 id="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó"><a href="#2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó" class="headerlink" title="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó"></a>2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó</h2><p>ÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÊü•ÁúãÊúçÂä°Âô®‰∏≠ËæìÂá∫ÁöÑSQLËØ≠Âè•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it server-proxy-a env LANG=C.UTF-8 /bin/bash<br>tail -f /opt/shardingsphere-proxy/logs/stdout.log <br></code></pre></td></tr></table></figure>

<h2 id="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï"><a href="#3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï" class="headerlink" title="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï"></a>3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> databases;<br>mysql<span class="hljs-operator">&gt;</span> use readwrite_splitting_db;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> tables;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_user;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_user;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> t_user(uname) <span class="hljs-keyword">values</span>(<span class="hljs-string">&#x27;wang5&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="4„ÄÅÂ∫îÁî®Á®ãÂ∫èËÆøÈóÆProxy"><a href="#4„ÄÅÂ∫îÁî®Á®ãÂ∫èËÆøÈóÆProxy" class="headerlink" title="4„ÄÅÂ∫îÁî®Á®ãÂ∫èËÆøÈóÆProxy"></a>4„ÄÅÂ∫îÁî®Á®ãÂ∫èËÆøÈóÆProxy</h2><h3 id="4-1„ÄÅÂàõÂª∫È°πÁõÆ"><a href="#4-1„ÄÅÂàõÂª∫È°πÁõÆ" class="headerlink" title="4.1„ÄÅÂàõÂª∫È°πÁõÆ"></a>4.1„ÄÅÂàõÂª∫È°πÁõÆ</h3><p>È°πÁõÆÁ±ªÂûãÔºöSpring Initializr</p>
<p>SpringBootËÑöÊâãÊû∂Ôºö<a target="_blank" rel="noopener" href="http://start.aliyun.com/">http://start.aliyun.com</a></p>
<p>È°πÁõÆÂêçÔºösharding-proxy-demo</p>
<p>SpringBootÁâàÊú¨Ôºö2.3.7.RELEASE</p>
<h3 id="4-2„ÄÅÊ∑ªÂä†‰æùËµñ"><a href="#4-2„ÄÅÊ∑ªÂä†‰æùËµñ" class="headerlink" title="4.2„ÄÅÊ∑ªÂä†‰æùËµñ"></a>4.2„ÄÅÊ∑ªÂä†‰æùËµñ</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="4-3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"><a href="#4-3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª" class="headerlink" title="4.3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª"></a>4.3„ÄÅÂàõÂª∫ÂÆû‰ΩìÁ±ª</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingproxydemo.entity;<br><br><span class="hljs-meta">@TableName(&quot;t_user&quot;)</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String uname;<br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="4-4„ÄÅÂàõÂª∫Mapper"><a href="#4-4„ÄÅÂàõÂª∫Mapper" class="headerlink" title="4.4„ÄÅÂàõÂª∫Mapper"></a>4.4„ÄÅÂàõÂª∫Mapper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingproxydemo.mapper;<br><br><span class="hljs-meta">@Mapper</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="4-5„ÄÅÈÖçÁΩÆÊï∞ÊçÆÊ∫ê"><a href="#4-5„ÄÅÈÖçÁΩÆÊï∞ÊçÆÊ∫ê" class="headerlink" title="4.5„ÄÅÈÖçÁΩÆÊï∞ÊçÆÊ∫ê"></a>4.5„ÄÅÈÖçÁΩÆÊï∞ÊçÆÊ∫ê</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment"># Â∫îÁî®ÂêçÁß∞</span><br><span class="hljs-attr">spring.application.name</span>=<span class="hljs-string">sharding-proxy-demo</span><br><span class="hljs-comment"># ÂºÄÂèëÁéØÂ¢ÉËÆæÁΩÆ</span><br><span class="hljs-attr">spring.profiles.active</span>=<span class="hljs-string">dev</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#mysqlÊï∞ÊçÆÂ∫ìËøûÊé•ÔºàproxyÔºâ</span><br><span class="hljs-attr">spring.datasource.driver-class-name</span>=<span class="hljs-string">com.mysql.jdbc.Driver</span><br><span class="hljs-attr">spring.datasource.url</span>=<span class="hljs-string">jdbc:mysql://192.168.100.201:3321/readwrite_splitting_db?serverTimezone=GMT%2B8&amp;useSSL=false</span><br><span class="hljs-attr">spring.datasource.username</span>=<span class="hljs-string">root</span><br><span class="hljs-attr">spring.datasource.password</span>=<span class="hljs-string">root</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">#mybatisÊó•Âøó</span><br><span class="hljs-attr">mybatis-plus.configuration.log-impl</span>=<span class="hljs-string">org.apache.ibatis.logging.stdout.StdOutImpl</span><br></code></pre></td></tr></table></figure>
<h3 id="4-6„ÄÅÊµãËØï"><a href="#4-6„ÄÅÊµãËØï" class="headerlink" title="4.6„ÄÅÊµãËØï"></a>4.6„ÄÅÊµãËØï</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.atguigu.shardingproxydemo;<br><br><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ShardingProxyDemoApplicationTests</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ËØªÊï∞ÊçÆÊµãËØï</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSelectAll</span><span class="hljs-params">()</span>&#123;<br>        List&lt;User&gt; users = userMapper.selectList(<span class="hljs-literal">null</span>);<br>        users.forEach(System.out::println);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="Á¨¨09Á´†-ShardingSphere-ProxyÂûÇÁõ¥ÂàÜÁâá"><a href="#Á¨¨09Á´†-ShardingSphere-ProxyÂûÇÁõ¥ÂàÜÁâá" class="headerlink" title="Á¨¨09Á´† ShardingSphere-ProxyÂûÇÁõ¥ÂàÜÁâá"></a>Á¨¨09Á´† ShardingSphere-ProxyÂûÇÁõ¥ÂàÜÁâá</h1><h2 id="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂-1"><a href="#1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂-1" class="headerlink" title="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂"></a>1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</h2><p><strong>‰øÆÊîπÈÖçÁΩÆconfig-sharding.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">schemaName:</span> <span class="hljs-string">sharding_db</span><br><br><span class="hljs-attr">dataSources:</span><br>  <span class="hljs-attr">ds_0:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3301/db_user?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">ds_1:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3302/db_order?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br><br><span class="hljs-attr">rules:</span><br><span class="hljs-bullet">-</span> <span class="hljs-type">!SHARDING</span><br>  <span class="hljs-attr">tables:</span><br>    <span class="hljs-attr">t_user:</span><br>      <span class="hljs-attr">actualDataNodes:</span> <span class="hljs-string">ds_0.t_user</span><br>    <span class="hljs-attr">t_order:</span><br>      <span class="hljs-attr">actualDataNodes:</span> <span class="hljs-string">ds_1.t_order</span><br></code></pre></td></tr></table></figure>
<h2 id="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó-1"><a href="#2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó-1" class="headerlink" title="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó"></a>2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó</h2><p>ÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÊü•ÁúãÊúçÂä°Âô®‰∏≠ËæìÂá∫ÁöÑSQLËØ≠Âè•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it server-proxy-a env LANG=C.UTF-8 /bin/bash<br>tail -f /opt/shardingsphere-proxy/logs/stdout.log <br></code></pre></td></tr></table></figure>
<h2 id="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï-1"><a href="#3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï-1" class="headerlink" title="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï"></a>3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> databases;<br>mysql<span class="hljs-operator">&gt;</span> use sharding_db;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> tables;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_order;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_user;<br></code></pre></td></tr></table></figure>
<h1 id="Á¨¨10Á´†-ShardingSphere-ProxyÊ∞¥Âπ≥ÂàÜÁâá"><a href="#Á¨¨10Á´†-ShardingSphere-ProxyÊ∞¥Âπ≥ÂàÜÁâá" class="headerlink" title="Á¨¨10Á´† ShardingSphere-ProxyÊ∞¥Âπ≥ÂàÜÁâá"></a>Á¨¨10Á´† ShardingSphere-ProxyÊ∞¥Âπ≥ÂàÜÁâá</h1><h2 id="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂-2"><a href="#1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂-2" class="headerlink" title="1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂"></a>1„ÄÅ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂</h2><p><strong>‰øÆÊîπÈÖçÁΩÆconfig-sharding.yaml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">schemaName:</span> <span class="hljs-string">sharding_db</span><br><br><span class="hljs-attr">dataSources:</span><br>  <span class="hljs-attr">ds_user:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3301/db_user?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">ds_order0:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3310/db_order?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br>  <span class="hljs-attr">ds_order1:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://192.168.100.201:3311/db_order?serverTimezone=UTC&amp;useSSL=false</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">connectionTimeoutMilliseconds:</span> <span class="hljs-number">30000</span><br>    <span class="hljs-attr">idleTimeoutMilliseconds:</span> <span class="hljs-number">60000</span><br>    <span class="hljs-attr">maxLifetimeMilliseconds:</span> <span class="hljs-number">1800000</span><br>    <span class="hljs-attr">maxPoolSize:</span> <span class="hljs-number">50</span><br>    <span class="hljs-attr">minPoolSize:</span> <span class="hljs-number">1</span><br><br><span class="hljs-attr">rules:</span><br><span class="hljs-bullet">-</span> <span class="hljs-type">!SHARDING</span><br>  <span class="hljs-attr">tables:</span><br>    <span class="hljs-attr">t_user:</span><br>      <span class="hljs-attr">actualDataNodes:</span> <span class="hljs-string">ds_user.t_user</span><br><br>    <span class="hljs-attr">t_order:</span><br>      <span class="hljs-attr">actualDataNodes:</span> <span class="hljs-string">ds_order$&#123;0..1&#125;.t_order$&#123;0..1&#125;</span><br>      <span class="hljs-attr">databaseStrategy:</span><br>        <span class="hljs-attr">standard:</span><br>          <span class="hljs-attr">shardingColumn:</span> <span class="hljs-string">user_id</span><br>          <span class="hljs-attr">shardingAlgorithmName:</span> <span class="hljs-string">alg_mod</span><br>      <span class="hljs-attr">tableStrategy:</span><br>        <span class="hljs-attr">standard:</span><br>          <span class="hljs-attr">shardingColumn:</span> <span class="hljs-string">order_no</span><br>          <span class="hljs-attr">shardingAlgorithmName:</span> <span class="hljs-string">alg_hash_mod</span><br>      <span class="hljs-attr">keyGenerateStrategy:</span><br>        <span class="hljs-attr">column:</span> <span class="hljs-string">id</span><br>        <span class="hljs-attr">keyGeneratorName:</span> <span class="hljs-string">snowflake</span><br>    <span class="hljs-attr">t_order_item:</span><br>      <span class="hljs-attr">actualDataNodes:</span> <span class="hljs-string">ds_order$&#123;0..1&#125;.t_order_item$&#123;0..1&#125;</span><br>      <span class="hljs-attr">databaseStrategy:</span><br>        <span class="hljs-attr">standard:</span><br>          <span class="hljs-attr">shardingColumn:</span> <span class="hljs-string">user_id</span><br>          <span class="hljs-attr">shardingAlgorithmName:</span> <span class="hljs-string">alg_mod</span><br>      <span class="hljs-attr">tableStrategy:</span><br>        <span class="hljs-attr">standard:</span><br>          <span class="hljs-attr">shardingColumn:</span> <span class="hljs-string">order_no</span><br>          <span class="hljs-attr">shardingAlgorithmName:</span> <span class="hljs-string">alg_hash_mod</span><br>      <span class="hljs-attr">keyGenerateStrategy:</span><br>        <span class="hljs-attr">column:</span> <span class="hljs-string">id</span><br>        <span class="hljs-attr">keyGeneratorName:</span> <span class="hljs-string">snowflake</span><br><br>  <span class="hljs-attr">bindingTables:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">t_order,t_order_item</span><br><br><br>  <span class="hljs-attr">broadcastTables:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">t_dict</span><br><br>  <span class="hljs-attr">shardingAlgorithms:</span><br>    <span class="hljs-attr">alg_inline_userid:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">INLINE</span><br>      <span class="hljs-attr">props:</span><br>        <span class="hljs-attr">algorithm-expression:</span> <span class="hljs-string">server-order$-&gt;&#123;user_id</span> <span class="hljs-string">%</span> <span class="hljs-number">2</span><span class="hljs-string">&#125;</span><br>    <span class="hljs-attr">alg_mod:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">MOD</span><br>      <span class="hljs-attr">props:</span><br>        <span class="hljs-attr">sharding-count:</span> <span class="hljs-number">2</span><br>    <span class="hljs-attr">alg_hash_mod:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">HASH_MOD</span><br>      <span class="hljs-attr">props:</span><br>        <span class="hljs-attr">sharding-count:</span> <span class="hljs-number">2</span><br>  <br>  <span class="hljs-attr">keyGenerators:</span><br>    <span class="hljs-attr">snowflake:</span><br>      <span class="hljs-attr">type:</span> <span class="hljs-string">SNOWFLAKE</span><br><br></code></pre></td></tr></table></figure>
<h2 id="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó-2"><a href="#2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó-2" class="headerlink" title="2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó"></a>2„ÄÅÂÆûÊó∂Êü•ÁúãÊó•Âøó</h2><p>ÂèØ‰ª•ÈÄöËøáËøôÁßçÊñπÂºèÊü•ÁúãÊúçÂä°Âô®‰∏≠ËæìÂá∫ÁöÑSQLËØ≠Âè•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it server-proxy-a env LANG=C.UTF-8 /bin/bash<br>tail -f /opt/shardingsphere-proxy/logs/stdout.log <br></code></pre></td></tr></table></figure>
<h2 id="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï-2"><a href="#3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï-2" class="headerlink" title="3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï"></a>3„ÄÅËøúÁ®ãËÆøÈóÆÊµãËØï</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> databases;<br>mysql<span class="hljs-operator">&gt;</span> use sharding_db;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">show</span> tables;<br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_order; <span class="hljs-comment">--ÊµãËØïÊ∞¥Âπ≥ÂàÜÁâá</span><br>mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> t_dict; <span class="hljs-comment">--ÊµãËØïÂπøÊí≠Ë°®</span><br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ShardingSphere5</div>
      <div>http://example.com/2023/11/28/ShardingSphere5/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>‰ΩúËÄÖ</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>ÂèëÂ∏É‰∫é</div>
          <div>2023Âπ¥11Êúà28Êó•</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>ËÆ∏ÂèØÂçèËÆÆ</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ÁΩ≤Âêç">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/28/JUC/" title="JUC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">JUC</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/11/28/Summary/" title="Summary">
                        <span class="hidden-mobile">Summary</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ÁõÆÂΩï</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  <!-- 
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
   -->

  <!-- Ê∑ªÂä†ÁΩëÁ´ôËøêË°åÊó∂Èó¥ -->
  <div>
    <span id="timeDate">ËΩΩÂÖ•Â§©Êï∞...</span>
    <span id="times">ËΩΩÂÖ•Êó∂ÂàÜÁßí...</span>
    <script>
    var now = new Date();
    function createtime(){
        var grt= new Date("10/31/2023 00:00:00");//Ê≠§Â§Ñ‰øÆÊîπ‰Ω†ÁöÑÂª∫Á´ôÊó∂Èó¥ÊàñËÄÖÁΩëÁ´ô‰∏äÁ∫øÊó∂Èó¥
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){
            hnum = "0" + hnum;
        }
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){
                  mnum = "0" + mnum;
        }
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){
                  snum = "0" + snum;
        }
        document.getElementById("timeDate").innerHTML = "üöÄ  "+dnum+" Â§©";  //Ê≠§Ê¨°Ëá™ÂÆö‰πâÊòæÁ§∫ÂÜÖÂÆπ
        document.getElementById("times").innerHTML = hnum + " Â∞èÊó∂ " + mnum + " ÂàÜ " + snum + " Áßí";
    }  //Ê≠§Ê¨°Ëá™ÂÆö‰πâÊòæÁ§∫ÂÜÖÂÆπ
    setInterval("createtime()",250);
    </script>
  </div>
  
  
  
   <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>  
</div>


  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/snowflake.min.js"></script>



<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
</body>
</html>
